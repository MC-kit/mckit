import pytest
import numpy as np

from mckit.parser.mcnp_input_parser import mcnp_input_lexer, mcnp_input_parser
from mckit.parser.meshtal_parser import meshtal_lexer, meshtal_parser
from mckit.parser.mctal_parser import read_mctal
from mckit.utils import filename_resolver

file_resolver = filename_resolver()

@pytest.mark.parametrize('lex_file, expected', [
    ('parser_test_data/lex1.txt', [
        ('title', 'Title card', 1), ('separator', '\n', 1),
        ('int_number', 1, 2), ('int_number', 1, 2), ('-', '-', 2),
        ('flt_number', 1.0, 2), ('int_number', 1, 2), ('int_number', 2, 2),
        ('+', '+', 2), ('int_number', 3, 2), ('IMP', 'IMP', 2), (':', ':', 2),
        ('N', 'N', 2), ('int_number', 1, 2), ('separator', '\n', 2),
        ('int_number', 2, 3), ('void_material', '0', 3), ('int_number', 1, 3),
        ('-', '-', 3), ('int_number', 2, 3), ('int_number', 3, 3),
        ('IMP', 'IMP', 3), (':', ':', 3), ('P', 'P', 3), ('int_number', 0, 3),
        ('separator', '\n', 3),
        ('int_number', 3, 4), ('void_material', '0', 5), ('int_number', 1, 5),
        ('int_number', 2, 5), ('int_number', 3, 5), ('int_number', 4, 6),
        ('int_number', 5, 6), ('separator', '\n', 6),
        ('int_number', 4, 7), ('int_number', 2, 7), ('-', '-', 7),
        ('int_number', 5, 7), ('int_number', 1, 7), ('VOL', 'VOL', 8),
        ('int_number', 1, 8), ('separator', '\n', 8),
        ('int_number', 5, 9), ('void_material', '0', 9), ('-', '-', 9),
        ('int_number', 1, 9), ('int_number', 2, 9), ('blank_line', '\n', 9),
        ('int_number', 1, 11), ('surface_type', 'PX', 11), ('-', '-', 11),
        ('flt_number', 1.0, 11), ('separator', '\n', 11),
        ('int_number', 2, 12), ('surface_type', 'C/Y', 12),
        ('flt_number', 2.e-2, 12), ('-', '-', 12), ('flt_number', 0.3, 12),
        ('flt_number', 400, 12), ('blank_line', '\n', 12),
        ('MODE', 'MODE', 14), ('N', 'N', 14), ('separator', '\n', 14),
        ('VOL', 'VOL', 15), ('int_number', 1, 15), ('int_number', 2, 15),
        ('blank_line', '\n', 15)
    ]),
    ('parser_test_data/lex2.txt', [
        ('title', 'Title card', 1), ('separator', '\n', 3),
        ('int_number', 1, 4), ('int_number', 1, 4), ('-', '-', 4),
        ('flt_number', 1.0, 4), ('int_number', 1, 4), ('int_number', 2, 4),
        ('+', '+', 4), ('int_number', 3, 4), ('IMP', 'IMP', 4), (':', ':', 4),
        ('N', 'N', 4), ('int_number', 1, 4), ('separator', '\n', 5),
        ('int_number', 2, 6), ('void_material', '0', 6), ('int_number', 1, 6),
        ('-', '-', 6), ('int_number', 2, 6), ('int_number', 3, 9),
        ('IMP', 'IMP', 9), (':', ':', 9), ('P', 'P', 9), ('int_number', 0, 9),
        ('separator', '\n', 9),
        ('int_number', 3, 10), ('void_material', '0', 11), ('int_number', 1, 11),
        ('int_number', 2, 11), ('int_number', 3, 11), ('int_number', 4, 12),
        ('int_number', 5, 12), ('separator', '\n', 12),
        ('int_number', 4, 13), ('int_number', 2, 13), ('-', '-', 13),
        ('int_number', 5, 13), ('int_number', 1, 13), ('VOL', 'VOL', 14),
        ('int_number', 1, 14), ('separator', '\n', 14),
        ('int_number', 5, 15), ('void_material', '0', 15), ('-', '-', 15),
        ('int_number', 1, 15), ('int_number', 2, 15), ('blank_line', '\n', 16),
        ('int_number', 1, 20), ('surface_type', 'PX', 20), ('-', '-', 20),
        ('flt_number', 1.0, 20), ('separator', '\n', 20),
        ('int_number', 2, 21), ('surface_type', 'C/Y', 21),
        ('flt_number', 2.e-2, 21), ('-', '-', 21), ('flt_number', 0.3, 21),
        ('flt_number', 400, 21), ('blank_line', '\n', 21),
        ('MODE', 'MODE', 23), ('N', 'N', 23), ('separator', '\n', 23),
        ('VOL', 'VOL', 24), ('int_number', 1, 24), ('int_number', 2, 24),
        ('separator', '\n', 24),
        ('M', 'M', 25), ('int_number', 1, 25), ('int_number', 1001, 25),
        ('.', '.', 25), ('lib_spec', '50C', 25), ('blank_line', '\n', 26)
    ]),
    ('parser_test_data/lex3.txt', [
        ('title', 'Title card', 1), ('separator', '\n', 3),
        ('int_number', 1, 4), ('int_number', 1, 4), ('-', '-', 4),
        ('flt_number', 1.0, 4), ('int_number', 1, 4), ('int_number', 2, 4),
        ('+', '+', 4), ('int_number', 3, 4), ('IMP', 'IMP', 4), (':', ':', 4),
        ('N', 'N', 4), ('int_number', 1, 4), ('separator', '\n', 5),
        ('int_number', 2, 6), ('void_material', '0', 6), ('int_number', 1, 6),
        ('-', '-', 6), ('int_number', 2, 6), ('int_number', 3, 9),
        ('IMP', 'IMP', 9), (':', ':', 9), ('P', 'P', 9), ('int_number', 0, 9),
        ('separator', '\n', 9),
        ('int_number', 3, 10), ('void_material', '0', 11), ('int_number', 1, 11),
        ('int_number', 2, 11), ('int_number', 3, 11), ('int_number', 4, 12),
        ('int_number', 5, 12), ('separator', '\n', 12),
        ('int_number', 4, 13), ('int_number', 2, 13), ('-', '-', 13),
        ('int_number', 5, 13), ('int_number', 1, 13), ('VOL', 'VOL', 14),
        ('int_number', 1, 14), ('separator', '\n', 14),
        ('int_number', 5, 15), ('void_material', '0', 15), ('-', '-', 15),
        ('int_number', 1, 15), ('int_number', 2, 15), (ValueError, 16, 15)
    ]),
    ('parser_test_data/lex4.txt', [
        ('title', 'Title card', 1), ('separator', '\n', 1),
        ('int_number', 1, 2), ('int_number', 1, 2), ('-', '-', 2),
        ('flt_number', 1.0, 2), ('int_number', 1, 2), ('int_number', 2, 2),
        ('+', '+', 2), ('int_number', 3, 2), ('IMP', 'IMP', 2), (':', ':', 2),
        ('N', 'N', 2), ('int_number', 1, 2), ('separator', '\n', 2),
        ('int_number', 2, 3), ('void_material', '0', 3), ('int_number', 1, 3),
        ('-', '-', 3), ('int_number', 2, 3), ('int_number', 3, 3),
        (ValueError, 3, 17)
    ]),
    ('parser_test_data/lex5.txt', [
        ('title', 'Title card', 1), ('separator', '\n', 1),
        ('int_number', 1, 2), ('int_number', 1, 2), ('-', '-', 2),
        ('flt_number', 1.0, 2), ('int_number', 1, 2), ('int_number', 2, 2),
        ('+', '+', 2), ('int_number', 3, 2), ('IMP', 'IMP', 2), (':', ':', 2),
        ('N', 'N', 2), ('int_number', 1, 2), ('separator', '\n', 2),
        ('int_number', 2, 3), ('void_material', '0', 3), ('int_number', 1, 3),
        ('-', '-', 3), ('int_number', 2, 3), ('int_number', 3, 3),
        ('IMP', 'IMP', 3), (':', ':', 3), ('P', 'P', 3), ('int_number', 0, 3),
        ('separator', '\n', 3),
        ('int_number', 3, 4), ('void_material', '0', 5), ('int_number', 1, 5),
        ('int_number', 2, 5), ('int_number', 3, 5), ('int_number', 4, 6),
        ('int_number', 5, 6), ('separator', '\n', 6),
        ('int_number', 4, 7), ('int_number', 2, 7), ('-', '-', 7),
        ('int_number', 5, 7), ('int_number', 1, 7), ('VOL', 'VOL', 8),
        ('int_number', 1, 8), ('separator', '\n', 8),
        ('int_number', 5, 9), ('void_material', '0', 9), ('-', '-', 9),
        ('int_number', 1, 9), ('int_number', 2, 9), ('blank_line', '\n', 9),
        ('int_number', 1, 11), (ValueError, 11, 3)
    ]),
    ('parser_test_data/lex6.txt', [
        ('title', 'Title card', 1), ('separator', '\n', 1),
        ('int_number', 1, 2), ('int_number', 1, 2), ('-', '-', 2),
        ('flt_number', 1.0, 2), ('int_number', 1, 2), ('int_number', 2, 2),
        ('+', '+', 2), ('int_number', 3, 2), ('IMP', 'IMP', 2), (':', ':', 2),
        ('N', 'N', 2), ('int_number', 1, 2), ('separator', '\n', 2),
        ('int_number', 2, 3), ('void_material', '0', 3), ('int_number', 1, 3),
        ('-', '-', 3), ('int_number', 2, 3), ('int_number', 3, 3),
        ('IMP', 'IMP', 3), (':', ':', 3), ('P', 'P', 3), ('int_number', 0, 3),
        ('separator', '\n', 3),
        ('int_number', 3, 4), ('void_material', '0', 5), ('int_number', 1, 5),
        ('int_number', 2, 5), ('int_number', 3, 5), ('int_number', 4, 6),
        ('int_number', 5, 6), ('separator', '\n', 6),
        ('int_number', 4, 7), ('int_number', 2, 7), ('-', '-', 7),
        ('int_number', 5, 7), ('int_number', 1, 7), ('VOL', 'VOL', 8),
        ('int_number', 1, 8), ('separator', '\n', 8),
        ('int_number', 5, 9), ('void_material', '0', 9), ('-', '-', 9),
        ('int_number', 1, 9), ('int_number', 2, 9), ('blank_line', '\n', 9),
        ('int_number', 1, 11), ('surface_type', 'PX', 11), ('-', '-', 11),
        ('flt_number', 1.0, 11), ('separator', '\n', 11),
        ('int_number', 2, 12), ('surface_type', 'C/Y', 12),
        ('flt_number', 2.e-2, 12), ('-', '-', 12), ('flt_number', 0.3, 12),
        ('flt_number', 400, 12), ('blank_line', '\n', 12),
        ('MODE', 'MODE', 14), ('N', 'N', 14), ('separator', '\n', 14),
        (ValueError, 15, 1)
    ])
])
def test_mcnp_lexer(lex_file, expected):
    lex_file = file_resolver(lex_file)
    with open(lex_file) as f:
        text = f.read()
    mcnp_input_lexer.begin('INITIAL')
    mcnp_input_lexer.input(text)
    for l in expected:
        if isinstance(l[0], str):
            t = mcnp_input_lexer.token()
            assert l[0] == t.type
            assert l[1] == t.value
            assert l[2] == t.lineno
        else:
            with pytest.raises(l[0]) as ex:
                mcnp_input_lexer.token()
            msg, sym, line, column = ex.value.args
            assert l[1] == line
            assert l[2] == column


@pytest.mark.parametrize('parse_file, expected', [
    ('parser_test_data/parser1.txt', {
        'title': 'mcnp parsing test file',
        'cells': {
            1: {
                'geometry': [1, 2, 'C', 'I', 3, 'I'],
                'IMPN': 1, 'MAT': {'composition': 1, 'density': 2.0}, 'name': 1
            },
            2: {
                'geometry': [1, 2, 'C', 3, 4, 'I', 'U', 'I'],
                'VOL': 1, 'MAT': {'composition': 2, 'density': 3.5}, 'name': 2
            },
            3: {
                'geometry': [2, 2, '#', 'I', 1, 'C', 3, 'U', 'C', 'I'],
                'IMPN': 1, 'IMPP': 1, 'name': 3
            },
            4: {
                'reference': 1, 'RHO': -3.0, 'name': 4
            },
            5: {
                'geometry': [5, 'C', 6, 'C', 'I'],
                'IMPN': 1, 'name': 5
            }
        },
        'surfaces': {
            1: {'kind': 'SX', 'params': [4, 5], 'transform': 1, 'name': 1},
            2: {'kind': 'PX', 'params': [1], 'modifier': '*', 'name': 2},
            3: {'kind': 'S', 'params': [1, 2, -3, 4], 'name':3},
            4: {'kind': 'PY', 'params': [-5], 'name': 4},
            5: {'name': 5, 'kind': 'RCC', 'params': [0, 0, 0, 1, 0, 0, 5]},
            6: {'name': 6, 'kind': 'BOX', 'params': [-1, -1, -1, 2, 0, 0, 0, 2, 0, 0, 0, 2]}
        },
        'data': {
            'MODE': ['N', 'P'],
            'M': {
                1: {'atomic': [(1001, {}, 0.1), (1002, {}, 0.9)], 'name': 1},
                2: {'weight': [(6012, {'lib': '50C'}, 0.5),
                               (8016, {'lib': '21C'}, 0.5)], 'name': 2},
                3: {'atomic': [(1001, {}, 0.1), (1002, {}, 0.9)], 'GAS': 1,
                    'name': 3},
                4: {'atomic': [(1001, {}, 0.1)], 'weight': [(1002, {}, 0.9)],
                    'GAS': 1, 'NLIB': '50C', 'name': 4}
            },
            'TR': {
                1: {'translation': [1, 2, 3], 'name': 1}
            }
        }
    }),
    ('parser_test_data/parser2.txt', {
        'title': 'mcnp parsing test file 2',
        'cells': {
            1: {
                'geometry': [1, 'C', 2, 'I', 3, 'C', 'U'],
                'MAT': {'composition': 1, 'density': 0.5}, 'IMPN': 1, 'name': 1
            },
            2: {
                'geometry': [1, 2, 'C', 3, 4, 'I', 5, 6, 'C', 'U', 'I', 'U', 'I',
                             7, 'U'],
                'MAT': {'composition': 2, 'concentration': 1.0e+24}, 'U': 1,
                'IMPN': 2, 'TRCL': 1, 'name': 2
            },
            3: {'geometry': [8, 9, 'I', 10, 'C', 'I'], 'FILL': {'universe': 1},
                'name': 3},
            4: {
                'geometry': [10, 11, 'C', 'I', 12, 'I'], 'name': 4,
                'TRCL': {'translation': [1, 2, 3],
                         'rotation': [30, 60, 90, 120, 30, 90, 90, 90, 0]}
            },
            5: {
                'reference': 3, 'name': 5,
                'TRCL': {'translation': [1, 2, 3], 'indegrees': True,
                         'rotation': [30, 60, 90, 120, 30, 90, 90, 90, 0]}
            },
            6: {
                'geometry': [16, 17, 'C', 'I', 18, 'I'],
                'FILL': {'universe': 1, 'transform': 2}, 'name': 6,
                'comment': ['comment 1', 'comment 2', 'comment 3']
            },
            7: {
                'geometry': [19, 20, 'C', 'I', 21, 'I'], 'name': 7,
                'FILL': {'universe': 1, 'transform': {'translation': [1, 2, 3],
                         'rotation': [30, 60, 90, 120, 30, 90, 90, 90, 0]}}
            },
            8: {
                'geometry': [22, 23, 'C', 'I', 24, 'I'],
                'FILL': {'universe': 1, 'transform': {'translation': [1, 2, 3],
                         'rotation': [30, 60, 90, 120, 30, 90, 90, 90, 0],
                         'indegrees': True}}, 'name': 8
            }
        },
        'surfaces': {
            1: {'kind': 'PX', 'params': [1], 'modifier': '*', 'name': 1},
            2: {'kind': 'PY', 'params': [2], 'modifier': '+', 'name': 2},
            3: {'kind': 'PZ', 'params': [3], 'name': 3},
            4: {'kind': 'P', 'params': [1, 2, -3, -5], 'name': 4, 'comment': ['comment 4']},
            5: {'kind': 'SO', 'params': [3], 'name': 5},
            6: {'kind': 'SX', 'params': [4, 5], 'name': 6},
            7: {'kind': 'SY', 'params': [-4, 5], 'name': 7},
            8: {'kind': 'SZ', 'params': [2.0, 6.3], 'name': 8},
            9: {'kind': 'S', 'params': [-1, 2.3, -4.1, 6], 'name': 9},
            10: {'kind': 'CX', 'params': [2, 5], 'name': 10},
            11: {'kind': 'CY', 'params': [2, 5], 'name': 11},
            12: {'kind': 'CZ', 'params': [2, 5], 'name': 12},
            13: {'kind': 'C/X', 'params': [2, 3, 5], 'name': 13},
            14: {'kind': 'C/Y', 'params': [2, 3, 5], 'name': 14},
            15: {'kind': 'C/Z', 'params': [2, 3, 5], 'name': 15},
            16: {'kind': 'KX', 'params': [2, 0.5], 'name': 16},
            17: {'kind': 'KY', 'params': [2, 0.5], 'name': 17},
            18: {'kind': 'KZ', 'params': [2, 0.5], 'name': 18},
            19: {'kind': 'K/X', 'params': [1, 2, 3, 0.5], 'name': 19},
            20: {'kind': 'K/Y', 'params': [1, 2, 3, 0.5], 'name': 20},
            21: {'kind': 'K/Z', 'params': [1, 2, 3, 0.5], 'name': 21},
            22: {'kind': 'TX', 'params': [1, 2, 3, 4, 5, 8], 'name': 22},
            23: {'kind': 'TY', 'params': [1, 2, 3, 4, 5, 8], 'name': 23},
            24: {'kind': 'TZ', 'params': [1, 2, 3, 4, 5, 8], 'name': 24},
            25: {'kind': 'SQ', 'params': [1, 2, 3, 4, 5, 6, 7, 8, 9], 'name': 25},
            26: {'kind': 'GQ', 'params': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 'name': 26,
                 'comment': ['comment 5']}
        },
        'data': {
            'TR': {
                1: {'translation': [1, 2, 3], 'name': 1, 'comment': ['comment 6'],
                    'rotation': [1, 1, 1, 2, 2, 2, 3, 3, 3], 'inverted': True},
                2: {'translation': [1, 2, 3], 'indegrees': True, 'inverted': True,
                    'rotation': [30, 60, 90, 120, 30, 90, 90, 90, 0], 'name': 2},
                3: {'translation': [1, 2, 3], 'indegrees': True, 'name': 3,
                    'rotation': [30, 60, 90, 120, 30, 90, 90, 90, 0]},
                4: {'translation': [1, 2, 3], 'indegrees': True, 'name': 4,
                    'rotation': [30, 60, 90, 120, 30, 90]},
                5: {'translation': [1, 2, 3], 'indegrees': True, 'name': 5,
                    'rotation': [30, 60, 90, 120, 30]},
                6: {'translation': [1, 2, 3], 'indegrees': True, 'name': 6,
                    'rotation': [30, 60, 90]},
                7: {'translation': [1, 2, 3], 'indegrees': True, 'name': 7}
            }
        }
    })
])
def test_mcnp_parser(parse_file, expected):
    parse_file = file_resolver(parse_file)
    with open(parse_file) as f:
        text = f.read()
    mcnp_input_lexer.begin('INITIAL')
    title, cells, surfaces, data = mcnp_input_parser.parse(text, lexer=mcnp_input_lexer)
    assert expected['title'] == title
    assert expected['cells'] == cells
    assert expected['surfaces'] == surfaces
    assert expected['data'] == data


@pytest.mark.parametrize('mesh_file, expected', [
    ('parser_test_data/fmesh.m', {
        'date': '05/24/1812:21:45',
        'histories': 10000000.00,
        'title': 'fmesh test',
        'tallies': [
            {
                'name': 14, 'particle': 'NEUTRON', 'geom': 'XYZ',
                'bins': {
                    'ENERGY': np.array([0.00E+00, 1.00E+36]),
                    'X': np.array([-3.00, -1.00, 1.00, 3.00]), 'Y': np.array([-3.00, -1.00, 1.00, 3.00, 5.00]),
                    'Z': np.array([-4.00, -1.60, 0.80, 3.20, 5.60, 8.00])
                },
                'result': np.array([
                    [
                        [
                            [7.18813E-03, 3.06754E-03, 1.46764E-03, 7.66660E-04, 4.03778E-04],
                            [1.06634E-02, 3.67344E-03, 1.64976E-03, 8.36825E-04, 4.28819E-04],
                            [7.17257E-03, 3.06150E-03, 1.47022E-03, 7.71489E-04, 3.98268E-04],
                            [3.47599E-03, 1.93182E-03, 1.04730E-03, 5.73177E-04, 3.11514E-04]
                        ],
                        [
                            [1.06743E-02, 3.67618E-03, 1.64985E-03, 8.36179E-04, 4.36976E-04],
                            [2.01953E-02, 4.44305E-03, 1.83404E-03, 9.03003E-04, 4.60324E-04],
                            [1.06720E-02, 3.66319E-03, 1.63652E-03, 8.30197E-04, 4.30752E-04],
                            [4.24826E-03, 2.24115E-03, 1.18622E-03, 6.40838E-04, 3.43042E-04]
                        ],
                        [
                            [7.21022E-03, 3.08980E-03, 1.48035E-03, 7.68615E-04, 4.02710E-04],
                            [1.06646E-02, 3.66923E-03, 1.63603E-03, 8.31973E-04, 4.26487E-04],
                            [7.19676E-03, 3.07813E-03, 1.47782E-03, 7.74412E-04, 4.05770E-04],
                            [3.47633E-03, 1.93512E-03, 1.05235E-03, 5.78607E-04, 3.11651E-04]
                        ]
                    ]
                ]),
                'error': np.array([
                    [
                        [
                            [0.00169, 0.00264, 0.00386, 0.00532, 0.00722],
                            [0.00137, 0.00243, 0.00366, 0.00515, 0.00705],
                            [0.00169, 0.00264, 0.00384, 0.00532, 0.00727],
                            [0.00233, 0.00319, 0.00437, 0.00593, 0.00800]
                        ],
                        [
                            [0.00137, 0.00243, 0.00367, 0.00514, 0.00698],
                            [0.00093, 0.00221, 0.00350, 0.00497, 0.00682],
                            [0.00137, 0.00243, 0.00368, 0.00517, 0.00703],
                            [0.00212, 0.00302, 0.00419, 0.00572, 0.00774]
                        ],
                        [
                            [0.00169, 0.00263, 0.00383, 0.00534, 0.00725],
                            [0.00137, 0.00243, 0.00368, 0.00516, 0.00705],
                            [0.00169, 0.00264, 0.00384, 0.00531, 0.00720],
                            [0.00233, 0.00319, 0.00436, 0.00589, 0.00800]
                        ]
                    ]
                ])
            },
            {
                'name': 24, 'particle': 'PHOTON', 'geom': 'CYL',
                'origin': np.array([-3.00E+00, -3.00E+00, -4.00E+00]), 'axis': np.array([0.000E+00, 0.000E+00, 1.000E+00]),
                'bins': {
                    'ENERGY': np.array([0.00E+00, 6.67E+00, 1.33E+01, 2.00E+01]),
                    'R': np.array([0.00, 1.00, 2.00, 3.00]), 'Z': np.array([0.00, 1.25, 2.50, 3.75, 5.00]),
                    'THETA': np.array([0.000, 0.200, 0.400, 0.600, 0.800, 1.000])
                },
                'result': np.array([
                    [
                        [
                            [4.26676E-04, 3.60929E-04, 2.51881E-04, 2.35336E-04, 3.27815E-04],
                            [4.17376E-04, 3.74891E-04, 2.65612E-04, 2.47303E-04, 3.41729E-04],
                            [3.52530E-04, 3.21725E-04, 2.39415E-04, 2.22406E-04, 2.87633E-04],
                            [2.91647E-04, 2.64957E-04, 2.03075E-04, 1.88207E-04, 2.53038E-04]
                        ],
                        [
                            [5.72802E-04, 4.02577E-04, 1.62808E-04, 1.47284E-04, 3.22879E-04],
                            [5.32281E-04, 3.90955E-04, 1.77012E-04, 1.56642E-04, 3.20700E-04],
                            [4.34871E-04, 3.36510E-04, 1.64430E-04, 1.47865E-04, 2.81179E-04],
                            [3.39817E-04, 2.74729E-04, 1.44850E-04, 1.30022E-04, 2.32783E-04]
                        ],
                        [
                            [7.68761E-04, 4.02569E-04, 1.09868E-04, 9.83327E-05, 2.85524E-04],
                            [6.74185E-04, 3.99908E-04, 1.23025E-04, 1.08080E-04, 2.97412E-04],
                            [5.11027E-04, 3.42010E-04, 1.15448E-04, 1.05403E-04, 2.57364E-04],
                            [3.89689E-04, 2.67553E-04, 1.05158E-04, 9.46154E-05, 2.10578E-04]
                        ]
                    ],
                    [
                        [
                            [0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [1.24150E-07, 5.58994E-09, 1.24827E-07, 0.00000E+00, 0.00000E+00],
                            [5.57853E-09, 2.64984E-08, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00]
                        ],
                        [
                            [3.31041E-08, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [4.24567E-08, 4.34742E-08, 4.24567E-08, 0.00000E+00, 0.00000E+00],
                            [0.00000E+00, 1.51344E-08, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [9.82692E-09, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00]
                        ],
                        [
                            [3.44266E-08, 3.21212E-08, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [4.55038E-08, 3.04180E-08, 2.54702E-08, 0.00000E+00, 0.00000E+00],
                            [3.03939E-09, 3.13872E-08, 4.05251E-09, 0.00000E+00, 0.00000E+00],
                            [2.19894E-09, 4.43644E-09, 3.78085E-08, 0.00000E+00, 0.00000E+00]
                        ]
                    ],
                    [
                        [
                            [1.61383E-07, 2.45465E-07, 4.80361E-08, 2.86873E-08, 1.36531E-07],
                            [0.00000E+00, 0.00000E+00, 6.11344E-08, 6.62558E-08, 6.94414E-08],
                            [1.79183E-07, 1.83093E-07, 1.26324E-07, 1.10180E-07, 9.84652E-08],
                            [1.15801E-07, 7.11787E-08, 9.61169E-08, 6.27373E-08, 9.09577E-08]
                        ],
                        [
                            [3.33988E-07, 3.02723E-07, 1.00276E-07, 4.54345E-08, 1.28529E-07],
                            [1.05911E-07, 0.00000E+00, 6.03481E-08, 6.20807E-08, 6.65379E-08],
                            [1.03901E-07, 1.16357E-07, 1.77282E-07, 6.12241E-08, 1.68246E-07],
                            [6.42099E-08, 5.82408E-08, 3.50897E-08, 1.41587E-07, 6.02894E-08]
                        ],
                        [
                            [4.35790E-07, 5.28413E-08, 6.09709E-08, 2.61146E-08, 2.55932E-07],
                            [1.36592E-07, 2.03173E-07, 6.40422E-08, 2.55531E-08, 1.59063E-07],
                            [2.33628E-07, 3.94338E-07, 1.14898E-07, 1.76035E-08, 9.71856E-08],
                            [2.10624E-07, 1.56979E-07, 7.03514E-08, 4.10227E-08, 1.43260E-07]
                        ]
                    ]
                ]),
                'error': np.array([
                    [
                        [
                            [1.51165E-02, 1.65362E-02, 1.95638E-02, 2.00471E-02, 1.74294E-02],
                            [1.54432E-02, 1.65796E-02, 1.93011E-02, 1.98625E-02, 1.73169E-02],
                            [1.70852E-02, 1.80477E-02, 2.04493E-02, 2.12808E-02, 1.90279E-02],
                            [1.91640E-02, 2.00755E-02, 2.24192E-02, 2.31940E-02, 2.06925E-02]
                        ],
                        [
                            [9.09560E-03, 1.13354E-02, 1.68719E-02, 1.73306E-02, 1.27127E-02],
                            [9.56337E-03, 1.15957E-02, 1.62495E-02, 1.68587E-02, 1.28723E-02],
                            [1.07933E-02, 1.25307E-02, 1.69082E-02, 1.73571E-02, 1.37630E-02],
                            [1.21292E-02, 1.38951E-02, 1.80609E-02, 1.84843E-02, 1.50679E-02]
                        ],
                        [
                            [6.46985E-03, 9.39907E-03, 1.63465E-02, 1.65062E-02, 1.11913E-02],
                            [7.10451E-03, 9.57794E-03, 1.55160E-02, 1.59039E-02, 1.11509E-02],
                            [8.19050E-03, 1.02979E-02, 1.59845E-02, 1.59556E-02, 1.17764E-02],
                            [9.40942E-03, 1.15396E-02, 1.66056E-02, 1.68655E-02, 1.28912E-02]
                        ]
                    ],
                    [
                        [
                            [0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [1.00000E+00, 1.00000E+00, 1.00000E+00, 0.00000E+00, 0.00000E+00],
                            [1.00000E+00, 1.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00]
                        ],
                        [
                            [1.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [1.00000E+00, 1.00000E+00, 1.00000E+00, 0.00000E+00, 0.00000E+00],
                            [0.00000E+00, 1.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [1.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00]
                        ],
                        [
                            [1.00000E+00, 1.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [7.94765E-01, 1.00000E+00, 1.00000E+00, 0.00000E+00, 0.00000E+00],
                            [1.00000E+00, 1.00000E+00, 1.00000E+00, 0.00000E+00, 0.00000E+00],
                            [1.00000E+00, 1.00000E+00, 1.00000E+00, 0.00000E+00, 0.00000E+00]
                        ]
                    ],
                    [
                        [
                            [7.13649E-01, 7.08199E-01, 7.92007E-01, 1.00000E+00, 7.98367E-01],
                            [0.00000E+00, 0.00000E+00, 1.00000E+00, 1.00000E+00, 1.00000E+00],
                            [7.37976E-01, 7.34192E-01, 8.08038E-01, 1.00000E+00, 9.90367E-01],
                            [1.00000E+00, 1.00000E+00, 1.00000E+00, 7.11428E-01, 1.00000E+00]
                        ],
                        [
                            [3.73939E-01, 4.35674E-01, 6.39167E-01, 1.00000E+00, 6.13512E-01],
                            [7.09827E-01, 0.00000E+00, 8.65521E-01, 8.21311E-01, 7.07324E-01],
                            [7.06117E-01, 6.58996E-01, 5.87822E-01, 8.92465E-01, 5.85102E-01],
                            [5.99586E-01, 7.93568E-01, 1.00000E+00, 5.39828E-01, 1.00000E+00]
                        ],
                        [
                            [2.74749E-01, 6.07463E-01, 7.11666E-01, 1.00000E+00, 3.38896E-01],
                            [4.70422E-01, 4.07795E-01, 7.12197E-01, 1.00000E+00, 4.89133E-01],
                            [4.69333E-01, 3.23265E-01, 4.92014E-01, 8.57334E-01, 5.38949E-01],
                            [3.71867E-01, 4.36175E-01, 7.21109E-01, 7.29208E-01, 4.55335E-01]
                        ]
                    ]
                ])
            },
            {
                'name': 34, 'particle': 'ELECTRON', 'geom': 'XYZ',
                'bins': {
                    'ENERGY': np.array([0.00E+00, 6.67E+00, 1.33E+01, 2.00E+01]),
                    'X': np.array([-3.00, -1.00, 1.00, 3.00]), 'Y': np.array([-3.00, -1.00, 1.00, 3.00, 5.00]),
                    'Z': np.array([-4.00, -1.60, 0.80, 3.20, 5.60, 8.00])
                },
                'result': np.array([
                    [
                        [
                            [2.15470E-05, 1.47842E-05, 8.41469E-06, 5.31042E-06, 2.58881E-06],
                            [2.90692E-05, 1.77388E-05, 9.66903E-06, 5.45955E-06, 3.11251E-06],
                            [2.20583E-05, 1.50941E-05, 8.60972E-06, 5.05476E-06, 3.02462E-06],
                            [1.09006E-05, 9.11214E-06, 6.48347E-06, 3.71926E-06, 2.25027E-06]
                        ],
                        [
                            [2.93677E-05, 1.70248E-05, 1.00628E-05, 5.66025E-06, 3.11381E-06],
                            [4.13888E-05, 2.01021E-05, 1.08080E-05, 6.11828E-06, 3.37041E-06],
                            [2.85739E-05, 1.71446E-05, 9.64213E-06, 5.33722E-06, 3.04467E-06],
                            [1.38698E-05, 1.14807E-05, 6.74720E-06, 4.62259E-06, 2.49310E-06]
                        ],
                        [
                            [2.14460E-05, 1.51609E-05, 8.42577E-06, 5.04945E-06, 2.89669E-06],
                            [2.77666E-05, 1.71581E-05, 1.01360E-05, 5.69297E-06, 3.08384E-06],
                            [2.15495E-05, 1.43817E-05, 8.53499E-06, 5.07401E-06, 2.83177E-06],
                            [1.13652E-05, 8.80429E-06, 5.28008E-06, 3.52305E-06, 2.07175E-06]
                        ]
                    ],
                    [
                        [
                            [0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [3.26852E-09, 9.89135E-09, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [7.96285E-09, 9.83845E-09, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [0.00000E+00, 0.00000E+00, 0.00000E+00, 1.13799E-08, 0.00000E+00]
                        ],
                        [
                            [0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [1.52051E-08, 1.18793E-08, 3.44674E-09, 0.00000E+00, 0.00000E+00],
                            [1.26318E-08, 0.00000E+00, 0.00000E+00, 6.67205E-09, 0.00000E+00],
                            [9.56817E-09, 3.09187E-09, 7.86285E-09, 1.18994E-09, 0.00000E+00]
                        ],
                        [
                            [4.66316E-09, 7.48677E-09, 2.88179E-09, 0.00000E+00, 0.00000E+00],
                            [0.00000E+00, 1.37866E-08, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [8.21988E-09, 2.23643E-08, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [1.70057E-09, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00]
                        ]

                    ],
                    [
                        [
                            [3.99267E-09, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [1.43729E-09, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [3.48114E-09, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00]
                        ],
                        [
                            [1.09841E-08, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [0.00000E+00, 0.00000E+00, 1.66217E-09, 0.00000E+00, 0.00000E+00],
                            [4.72261E-09, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [0.00000E+00, 8.79939E-10, 9.98414E-09, 8.32928E-09, 0.00000E+00]
                        ],
                        [
                            [1.09076E-08, 2.46367E-09, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [8.07081E-09, 4.18543E-09, 2.82902E-09, 0.00000E+00, 0.00000E+00],
                            [0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00]
                        ]

                    ]
                ]),
                'error': np.array([
                    [
                        [
                            [0.01902, 0.02288, 0.03020, 0.03851, 0.05383],
                            [0.01640, 0.02090, 0.02820, 0.03750, 0.04963],
                            [0.01886, 0.02272, 0.03020, 0.03915, 0.05082],
                            [0.02834, 0.03076, 0.03680, 0.04882, 0.06265]
                        ],
                        [
                            [0.01637, 0.02122, 0.02782, 0.03681, 0.04955],
                            [0.01390, 0.01960, 0.02668, 0.03578, 0.04802],
                            [0.01662, 0.02122, 0.02836, 0.03747, 0.04925],
                            [0.02380, 0.02623, 0.03377, 0.04113, 0.05499]
                        ],
                        [
                            [0.01907, 0.02275, 0.03038, 0.03881, 0.05075],
                            [0.01681, 0.02130, 0.02777, 0.03607, 0.04907],
                            [0.01913, 0.02315, 0.03017, 0.03899, 0.05175],
                            [0.02756, 0.03115, 0.03975, 0.04945, 0.06481]
                        ]
                    ],
                    [
                        [
                            [0.00000, 0.00000, 0.00000, 0.00000, 0.00000],
                            [1.00000, 1.00000, 0.00000, 0.00000, 0.00000],
                            [1.00000, 1.00000, 0.00000, 0.00000, 0.00000],
                            [0.00000, 0.00000, 0.00000, 1.00000, 0.00000]
                        ],
                        [
                            [0.00000, 0.00000, 0.00000, 0.00000, 0.00000],
                            [0.82592, 1.00000, 1.00000, 0.00000, 0.00000],
                            [0.70981, 0.00000, 0.00000, 1.00000, 0.00000],
                            [0.93217, 1.00000, 1.00000, 1.00000, 0.00000]
                        ],
                        [
                            [1.00000, 0.77600, 1.00000, 0.00000, 0.00000],
                            [0.00000, 0.89989, 0.00000, 0.00000, 0.00000],
                            [0.77883, 0.76382, 0.00000, 0.00000, 0.00000],
                            [1.00000, 0.00000, 0.00000, 0.00000, 0.00000]
                        ]
                    ],
                    [
                        [
                            [1.00000, 0.00000, 0.00000, 0.00000, 0.00000],
                            [1.00000, 0.00000, 0.00000, 0.00000, 0.00000],
                            [1.00000, 0.00000, 0.00000, 0.00000, 0.00000],
                            [0.00000, 0.00000, 0.00000, 0.00000, 0.00000]
                        ],
                        [
                            [1.00000, 0.00000, 0.00000, 0.00000, 0.00000],
                            [0.00000, 0.00000, 1.00000, 0.00000, 0.00000],
                            [1.00000, 0.00000, 0.00000, 0.00000, 0.00000],
                            [0.00000, 1.00000, 1.00000, 1.00000, 0.00000]
                        ],
                        [
                            [1.00000, 0.74901, 0.00000, 0.00000, 0.00000],
                            [0.00000, 0.00000, 0.00000, 0.00000, 0.00000],
                            [1.00000, 1.00000, 1.00000, 0.00000, 0.00000],
                            [0.00000, 0.00000, 0.00000, 0.00000, 0.00000]
                        ]
                    ]
                ])
            },
            {
                'name': 44, 'particle': 'NEUTRON', 'geom': 'CYL',
                'origin': np.array([-3.00E+00, -3.00E+00, -4.00E+00]), 'axis': np.array([0.000E+00, 0.000E+00, 1.000E+00]),
                'bins': {
                    'ENERGY': np.array([0.00E+00, 6.67E+00, 1.33E+01, 2.00E+01]),
                    'R': np.array([0.00, 1.00, 2.00, 3.00]), 'Z': np.array([0.00, 1.25, 2.50, 3.75, 5.00]),
                    'THETA': np.array([0.000, 0.200, 0.400, 0.600, 0.800, 1.000])
                },
                'result': np.array([
                    [
                        [
                            [6.36513E-04, 5.39688E-04, 3.56988E-04, 3.25666E-04, 4.90815E-04],
                            [6.81107E-04, 5.81260E-04, 3.95854E-04, 3.69511E-04, 5.38530E-04],
                            [5.91488E-04, 5.24466E-04, 3.66878E-04, 3.32395E-04, 4.83348E-04],
                            [4.84344E-04, 4.19087E-04, 2.96782E-04, 2.80874E-04, 3.97798E-04]
                        ],
                        [
                            [8.75449E-04, 5.96380E-04, 2.18626E-04, 1.89416E-04, 4.71914E-04],
                            [9.14165E-04, 6.39521E-04, 2.54077E-04, 2.16996E-04, 5.13943E-04],
                            [7.60698E-04, 5.53425E-04, 2.37453E-04, 2.02494E-04, 4.51437E-04],
                            [5.99848E-04, 4.56087E-04, 2.05150E-04, 1.78299E-04, 3.79469E-04]
                        ],
                        [
                            [1.16547E-03, 6.10956E-04, 1.44214E-04, 1.28095E-04, 4.19222E-04],
                            [1.12122E-03, 6.39670E-04, 1.66427E-04, 1.46253E-04, 4.61955E-04],
                            [9.04913E-04, 5.66029E-04, 1.66111E-04, 1.43689E-04, 4.10153E-04],
                            [6.83654E-04, 4.49291E-04, 1.49303E-04, 1.32920E-04, 3.40205E-04]
                        ]
                    ],
                    [
                        [
                            [5.68879E-04, 5.00413E-04, 3.63351E-04, 3.51731E-04, 4.65246E-04],
                            [5.74251E-04, 5.13881E-04, 3.69454E-04, 3.48172E-04, 4.67461E-04],
                            [4.55839E-04, 4.16947E-04, 3.17566E-04, 3.00836E-04, 3.90086E-04],
                            [3.52446E-04, 3.26314E-04, 2.55279E-04, 2.45904E-04, 3.07041E-04]
                        ],
                        [
                            [7.44170E-04, 5.41893E-04, 2.34327E-04, 2.04675E-04, 4.49847E-04],
                            [7.15024E-04, 5.39231E-04, 2.49338E-04, 2.21067E-04, 4.58030E-04],
                            [5.52225E-04, 4.30963E-04, 2.22508E-04, 1.99851E-04, 3.75739E-04],
                            [4.16330E-04, 3.40119E-04, 1.84454E-04, 1.72092E-04, 2.95224E-04]
                        ],
                        [
                            [9.82620E-04, 5.47755E-04, 1.53812E-04, 1.37189E-04, 3.99798E-04],
                            [8.61145E-04, 5.31881E-04, 1.65989E-04, 1.45397E-04, 4.07246E-04],
                            [6.41086E-04, 4.28584E-04, 1.60945E-04, 1.41904E-04, 3.40225E-04],
                            [4.62649E-04, 3.29253E-04, 1.41001E-04, 1.28809E-04, 2.68768E-04]
                        ]
                    ],
                    [
                        [
                            [4.47611E-03, 3.76194E-03, 2.78037E-03, 2.66749E-03, 3.44401E-03],
                            [2.80391E-03, 2.42859E-03, 1.86302E-03, 1.80358E-03, 2.24376E-03],
                            [1.77640E-03, 1.60347E-03, 1.29141E-03, 1.27639E-03, 1.52562E-03],
                            [1.14696E-03, 1.05410E-03, 9.04880E-04, 8.62988E-04, 1.00358E-03]
                        ],
                        [
                            [6.74332E-03, 4.23841E-03, 2.21247E-03, 2.08460E-03, 3.42436E-03],
                            [3.83163E-03, 2.68914E-03, 1.53160E-03, 1.43832E-03, 2.25032E-03],
                            [2.21608E-03, 1.70459E-03, 1.10556E-03, 1.05776E-03, 1.49573E-03],
                            [1.35022E-03, 1.09847E-03, 8.04995E-04, 7.82749E-04, 9.96630E-04]
                        ],
                        [
                            [1.09575E-02, 4.60953E-03, 1.78375E-03, 1.65950E-03, 3.25593E-03],
                            [5.19313E-03, 2.77331E-03, 1.26611E-03, 1.17277E-03, 2.12967E-03],
                            [2.70508E-03, 1.73632E-03, 9.59336E-04, 9.03811E-04, 1.44242E-03],
                            [1.54029E-03, 1.12071E-03, 7.15744E-04, 6.89978E-04, 9.75051E-04]
                        ]
                    ]
                ]),
                'error': np.array([
                    [
                        [
                            [0.01224, 0.01342, 0.01593, 0.01652, 0.01406],
                            [0.01208, 0.01310, 0.01534, 0.01564, 0.01366],
                            [0.01316, 0.01387, 0.01612, 0.01668, 0.01449],
                            [0.01451, 0.01572, 0.01797, 0.01826, 0.01614]
                        ],
                        [
                            [0.00731, 0.00910, 0.01382, 0.01457, 0.01018],
                            [0.00743, 0.00900, 0.01303, 0.01360, 0.00988],
                            [0.00817, 0.00959, 0.01342, 0.01411, 0.01052],
                            [0.00927, 0.01064, 0.01440, 0.01499, 0.01148]
                        ],
                        [
                            [0.00525, 0.00742, 0.01359, 0.01385, 0.00887],
                            [0.00556, 0.00738, 0.01271, 0.01300, 0.00856],
                            [0.00622, 0.00788, 0.01271, 0.01307, 0.00904],
                            [0.00716, 0.00878, 0.01334, 0.01361, 0.00988]
                        ]
                    ],
                    [
                        [
                            [0.01210, 0.01309, 0.01519, 0.01543, 0.01356],
                            [0.01227, 0.01311, 0.01520, 0.01556, 0.01362],
                            [0.01389, 0.01467, 0.01663, 0.01696, 0.01510],
                            [0.01599, 0.01676, 0.01851, 0.01884, 0.01717]
                        ],
                        [
                            [0.00732, 0.00902, 0.01334, 0.01399, 0.00996],
                            [0.00760, 0.00911, 0.01294, 0.01350, 0.00990],
                            [0.00867, 0.01007, 0.01367, 0.01414, 0.01088],
                            [0.01000, 0.01134, 0.01499, 0.01520, 0.01226]
                        ],
                        [
                            [0.00523, 0.00746, 0.01313, 0.01339, 0.00882],
                            [0.00566, 0.00757, 0.01265, 0.01288, 0.00877],
                            [0.00657, 0.00835, 0.01281, 0.01309, 0.00944],
                            [0.00771, 0.00940, 0.01360, 0.01371, 0.01052]
                        ]
                    ],
                    [
                        [
                            [0.00434, 0.00507, 0.00568, 0.00583, 0.00534],
                            [0.00567, 0.00645, 0.00705, 0.00721, 0.00671],
                            [0.00742, 0.00819, 0.00871, 0.00880, 0.00838],
                            [0.00954, 0.01034, 0.01069, 0.01089, 0.01049]
                        ],
                        [
                            [0.00238, 0.00382, 0.00439, 0.00438, 0.00422],
                            [0.00326, 0.00458, 0.00527, 0.00528, 0.00502],
                            [0.00437, 0.00555, 0.00624, 0.00621, 0.00595],
                            [0.00565, 0.00677, 0.00738, 0.00733, 0.00711]
                        ],
                        [
                            [0.00156, 0.00315, 0.00385, 0.00387, 0.00354],
                            [0.00229, 0.00366, 0.00454, 0.00458, 0.00412],
                            [0.00319, 0.00439, 0.00525, 0.00526, 0.00480],
                            [0.00424, 0.00531, 0.00610, 0.00606, 0.00567]
                        ]
                    ]
                ])
            },
            {
                'name': 54, 'particle': 'NEUTRON', 'geom': 'CYL',
                'origin': np.array([-3.00E+00, -3.00E+00, -4.00E+00]), 'axis': np.array([0.000E+00, 0.000E+00, 1.000E+00]),
                'bins': {
                    'ENERGY': np.array([0.00E+00, 6.67E+00, 1.33E+01, 2.00E+01]),
                    'R': np.array([0.00, 1.00, 2.00, 3.00]), 'Z': np.array([0.00, 1.25, 2.50, 3.75, 5.00]),
                    'THETA': np.array([0.000, 0.200, 0.400, 0.600, 0.800, 1.000])
                },
                'result': np.array([
                    [
                        [
                            [6.36513E-04, 5.39688E-04, 3.56988E-04, 3.25666E-04, 4.90815E-04],
                            [6.81107E-04, 5.81260E-04, 3.95854E-04, 3.69511E-04, 5.38530E-04],
                            [5.91488E-04, 5.24466E-04, 3.66878E-04, 3.32395E-04, 4.83348E-04],
                            [4.84344E-04, 4.19087E-04, 2.96782E-04, 2.80874E-04, 3.97798E-04]
                        ],
                        [
                            [8.75449E-04, 5.96380E-04, 2.18626E-04, 1.89416E-04, 4.71914E-04],
                            [9.14165E-04, 6.39521E-04, 2.54077E-04, 2.16996E-04, 5.13943E-04],
                            [7.60698E-04, 5.53425E-04, 2.37453E-04, 2.02494E-04, 4.51437E-04],
                            [5.99848E-04, 4.56087E-04, 2.05150E-04, 1.78299E-04, 3.79469E-04]
                        ],
                        [
                            [1.16547E-03, 6.10956E-04, 1.44214E-04, 1.28095E-04, 4.19222E-04],
                            [1.12122E-03, 6.39670E-04, 1.66427E-04, 1.46253E-04, 4.61955E-04],
                            [9.04913E-04, 5.66029E-04, 1.66111E-04, 1.43689E-04, 4.10153E-04],
                            [6.83654E-04, 4.49291E-04, 1.49303E-04, 1.32920E-04, 3.40205E-04]
                        ]
                    ],
                    [
                        [
                            [5.68879E-04, 5.00413E-04, 3.63351E-04, 3.51731E-04, 4.65246E-04],
                            [5.74251E-04, 5.13881E-04, 3.69454E-04, 3.48172E-04, 4.67461E-04],
                            [4.55839E-04, 4.16947E-04, 3.17566E-04, 3.00836E-04, 3.90086E-04],
                            [3.52446E-04, 3.26314E-04, 2.55279E-04, 2.45904E-04, 3.07041E-04]
                        ],
                        [
                            [7.44170E-04, 5.41893E-04, 2.34327E-04, 2.04675E-04, 4.49847E-04],
                            [7.15024E-04, 5.39231E-04, 2.49338E-04, 2.21067E-04, 4.58030E-04],
                            [5.52225E-04, 4.30963E-04, 2.22508E-04, 1.99851E-04, 3.75739E-04],
                            [4.16330E-04, 3.40119E-04, 1.84454E-04, 1.72092E-04, 2.95224E-04]
                        ],
                        [
                            [9.82620E-04, 5.47755E-04, 1.53812E-04, 1.37189E-04, 3.99798E-04],
                            [8.61145E-04, 5.31881E-04, 1.65989E-04, 1.45397E-04, 4.07246E-04],
                            [6.41086E-04, 4.28584E-04, 1.60945E-04, 1.41904E-04, 3.40225E-04],
                            [4.62649E-04, 3.29253E-04, 1.41001E-04, 1.28809E-04, 2.68768E-04]
                        ]
                    ],
                    [
                        [
                            [4.47611E-03, 3.76194E-03, 2.78037E-03, 2.66749E-03, 3.44401E-03],
                            [2.80391E-03, 2.42859E-03, 1.86302E-03, 1.80358E-03, 2.24376E-03],
                            [1.77640E-03, 1.60347E-03, 1.29141E-03, 1.27639E-03, 1.52562E-03],
                            [1.14696E-03, 1.05410E-03, 9.04880E-04, 8.62988E-04, 1.00358E-03]
                        ],
                        [
                            [6.74332E-03, 4.23841E-03, 2.21247E-03, 2.08460E-03, 3.42436E-03],
                            [3.83163E-03, 2.68914E-03, 1.53160E-03, 1.43832E-03, 2.25032E-03],
                            [2.21608E-03, 1.70459E-03, 1.10556E-03, 1.05776E-03, 1.49573E-03],
                            [1.35022E-03, 1.09847E-03, 8.04995E-04, 7.82749E-04, 9.96630E-04]
                        ],
                        [
                            [1.09575E-02, 4.60953E-03, 1.78375E-03, 1.65950E-03, 3.25593E-03],
                            [5.19313E-03, 2.77331E-03, 1.26611E-03, 1.17277E-03, 2.12967E-03],
                            [2.70508E-03, 1.73632E-03, 9.59336E-04, 9.03811E-04, 1.44242E-03],
                            [1.54029E-03, 1.12071E-03, 7.15744E-04, 6.89978E-04, 9.75051E-04]
                        ]
                    ]
                ]),
                'error': np.array([
                    [
                        [
                            [0.01224, 0.01342, 0.01593, 0.01652, 0.01406],
                            [0.01208, 0.01310, 0.01534, 0.01564, 0.01366],
                            [0.01316, 0.01387, 0.01612, 0.01668, 0.01449],
                            [0.01451, 0.01572, 0.01797, 0.01826, 0.01614]
                        ],
                        [
                            [0.00731, 0.00910, 0.01382, 0.01457, 0.01018],
                            [0.00743, 0.00900, 0.01303, 0.01360, 0.00988],
                            [0.00817, 0.00959, 0.01342, 0.01411, 0.01052],
                            [0.00927, 0.01064, 0.01440, 0.01499, 0.01148]
                        ],
                        [
                            [0.00525, 0.00742, 0.01359, 0.01385, 0.00887],
                            [0.00556, 0.00738, 0.01271, 0.01300, 0.00856],
                            [0.00622, 0.00788, 0.01271, 0.01307, 0.00904],
                            [0.00716, 0.00878, 0.01334, 0.01361, 0.00988]
                        ]
                    ],
                    [
                        [
                            [0.01210, 0.01309, 0.01519, 0.01543, 0.01356],
                            [0.01227, 0.01311, 0.01520, 0.01556, 0.01362],
                            [0.01389, 0.01467, 0.01663, 0.01696, 0.01510],
                            [0.01599, 0.01676, 0.01851, 0.01884, 0.01717]
                        ],
                        [
                            [0.00732, 0.00902, 0.01334, 0.01399, 0.00996],
                            [0.00760, 0.00911, 0.01294, 0.01350, 0.00990],
                            [0.00867, 0.01007, 0.01367, 0.01414, 0.01088],
                            [0.01000, 0.01134, 0.01499, 0.01520, 0.01226]
                        ],
                        [
                            [0.00523, 0.00746, 0.01313, 0.01339, 0.00882],
                            [0.00566, 0.00757, 0.01265, 0.01288, 0.00877],
                            [0.00657, 0.00835, 0.01281, 0.01309, 0.00944],
                            [0.00771, 0.00940, 0.01360, 0.01371, 0.01052]
                        ]
                    ],
                    [
                        [
                            [0.00434, 0.00507, 0.00568, 0.00583, 0.00534],
                            [0.00567, 0.00645, 0.00705, 0.00721, 0.00671],
                            [0.00742, 0.00819, 0.00871, 0.00880, 0.00838],
                            [0.00954, 0.01034, 0.01069, 0.01089, 0.01049]
                        ],
                        [
                            [0.00238, 0.00382, 0.00439, 0.00438, 0.00422],
                            [0.00326, 0.00458, 0.00527, 0.00528, 0.00502],
                            [0.00437, 0.00555, 0.00624, 0.00621, 0.00595],
                            [0.00565, 0.00677, 0.00738, 0.00733, 0.00711]
                        ],
                        [
                            [0.00156, 0.00315, 0.00385, 0.00387, 0.00354],
                            [0.00229, 0.00366, 0.00454, 0.00458, 0.00412],
                            [0.00319, 0.00439, 0.00525, 0.00526, 0.00480],
                            [0.00424, 0.00531, 0.00610, 0.00606, 0.00567]
                        ]
                    ]
                ])
            },
            {
                'name': 64, 'particle': 'ELECTRON', 'geom': 'XYZ',
                'bins': {
                    'ENERGY': np.array([1.00E-03, 1.00E+02]),
                    'X': np.array([-3.00, -1.00, 1.00, 3.00]), 'Y': np.array([-3.00, -1.00, 1.00, 3.00, 5.00]),
                    'Z': np.array([-4.00, -3.00, -2.00, -1.00, 0.00, 1.00])
                },
                'result': np.array([
                    [
                        [
                            [2.27419E-05, 2.17868E-05, 1.72577E-05, 1.53648E-05, 1.22356E-05],
                            [3.11127E-05, 2.85558E-05, 2.31183E-05, 1.84432E-05, 1.36892E-05],
                            [2.26343E-05, 2.23131E-05, 1.89640E-05, 1.47211E-05, 1.28286E-05],
                            [1.07191E-05, 1.14047E-05, 1.02882E-05, 9.13652E-06, 8.13062E-06]
                        ],
                        [
                            [3.05415E-05, 2.95938E-05, 2.37784E-05, 1.72760E-05, 1.26062E-05],
                            [4.66317E-05, 4.01764E-05, 2.83337E-05, 2.08623E-05, 1.43317E-05],
                            [3.00266E-05, 2.91989E-05, 2.23563E-05, 1.74685E-05, 1.32246E-05],
                            [1.29678E-05, 1.47402E-05, 1.37617E-05, 1.11206E-05, 9.89096E-06]
                        ],
                        [
                            [2.18894E-05, 2.16545E-05, 1.91636E-05, 1.47231E-05, 1.26959E-05],
                            [2.88450E-05, 2.85265E-05, 2.21880E-05, 1.67353E-05, 1.43432E-05],
                            [2.19202E-05, 2.23430E-05, 1.81618E-05, 1.49328E-05, 1.10308E-05],
                            [1.11572E-05, 1.18185E-05, 1.00818E-05, 9.17390E-06, 7.42903E-06]
                        ]
                    ]

                ]),
                'error': np.array([
                    [
                        [
                            [2.78362E-02, 2.81298E-02, 3.09657E-02, 3.30592E-02, 3.72776E-02],
                            [2.36916E-02, 2.42652E-02, 2.71698E-02, 3.04575E-02, 3.49528E-02],
                            [2.76754E-02, 2.76985E-02, 3.02390E-02, 3.40211E-02, 3.70110E-02],
                            [4.23854E-02, 4.03991E-02, 4.24013E-02, 4.51811E-02, 4.82304E-02]
                        ],
                        [
                            [2.36816E-02, 2.44779E-02, 2.70306E-02, 3.09652E-02, 3.63388E-02],
                            [1.94626E-02, 2.09634E-02, 2.45109E-02, 2.89800E-02, 3.39383E-02],
                            [2.40983E-02, 2.44504E-02, 2.73977E-02, 3.12602E-02, 3.52662E-02],
                            [3.67117E-02, 3.42116E-02, 3.58161E-02, 3.92775E-02, 4.15590E-02]
                        ],
                        [
                            [2.83303E-02, 2.81832E-02, 3.00929E-02, 3.37627E-02, 3.69545E-02],
                            [2.45929E-02, 2.47182E-02, 2.79120E-02, 3.20100E-02, 3.41955E-02],
                            [2.81071E-02, 2.80327E-02, 3.07090E-02, 3.35533E-02, 3.82874E-02],
                            [4.15137E-02, 3.92549E-02, 4.21972E-02, 4.47530E-02, 5.03052E-02]
                        ]
                    ]
                ])
            },
            {
                'name': 74, 'particle': 'NEUTRON', 'geom': 'XYZ',
                'bins': {
                    'ENERGY': np.array([0.00E+00, 1.00E+36]),
                    'X': np.array([-3.00, -1.00, 1.00, 3.00]), 'Y': np.array([-3.00, -1.00, 1.00, 3.00, 5.00]),
                    'Z': np.array([-4.00, -3.00, -2.00, -1.00, 0.00, 1.00])
                },
                'result': np.array([
                    [
                        [
                            [9.04444E-03, 6.27702E-03, 4.35550E-03, 3.08614E-03, 2.24486E-03],
                            [1.45306E-02, 8.59736E-03, 5.46472E-03, 3.67699E-03, 2.59166E-03],
                            [9.03290E-03, 6.26415E-03, 4.33504E-03, 3.08761E-03, 2.23683E-03],
                            [4.06754E-03, 3.19242E-03, 2.51993E-03, 1.96192E-03, 1.50871E-03]
                        ],
                        [
                            [1.45132E-02, 8.63447E-03, 5.47173E-03, 3.68526E-03, 2.58725E-03],
                            [3.19700E-02, 1.31972E-02, 7.10455E-03, 4.40634E-03, 2.96430E-03],
                            [1.45048E-02, 8.63950E-03, 5.46359E-03, 3.67178E-03, 2.57053E-03],
                            [4.99942E-03, 3.89479E-03, 2.99886E-03, 2.26266E-03, 1.73108E-03]
                        ],
                        [
                            [9.08998E-03, 6.27654E-03, 4.38343E-03, 3.11244E-03, 2.25694E-03],
                            [1.44999E-02, 8.62357E-03, 5.47940E-03, 3.67164E-03, 2.57404E-03],
                            [9.09387E-03, 6.25030E-03, 4.35821E-03, 3.10312E-03, 2.25166E-03],
                            [4.06678E-03, 3.19813E-03, 2.51588E-03, 1.95568E-03, 1.52583E-03]
                        ]
                    ]
                ]),
                'error': np.array([
                    [
                        [
                            [1.97528E-03, 2.24830E-03, 2.63811E-03, 3.10952E-03, 3.63575E-03],
                            [1.46500E-03, 1.84926E-03, 2.30835E-03, 2.81878E-03, 3.36778E-03],
                            [1.97542E-03, 2.25144E-03, 2.64319E-03, 3.10959E-03, 3.62573E-03],
                            [3.04694E-03, 3.26414E-03, 3.53917E-03, 3.92537E-03, 4.38197E-03]
                        ],
                        [
                            [1.46549E-03, 1.84509E-03, 2.30611E-03, 2.81385E-03, 3.36711E-03],
                            [8.39012E-04, 1.39430E-03, 1.95952E-03, 2.53111E-03, 3.11841E-03],
                            [1.46653E-03, 1.84612E-03, 2.30960E-03, 2.81762E-03, 3.37416E-03],
                            [2.73104E-03, 2.95514E-03, 3.25122E-03, 3.66135E-03, 4.13756E-03]
                        ],
                        [
                            [1.97264E-03, 2.24742E-03, 2.63617E-03, 3.08949E-03, 3.61779E-03],
                            [1.46565E-03, 1.84595E-03, 2.30669E-03, 2.81720E-03, 3.37333E-03],
                            [1.97189E-03, 2.25217E-03, 2.63446E-03, 3.09805E-03, 3.62754E-03],
                            [3.04754E-03, 3.26402E-03, 3.54243E-03, 3.91995E-03, 4.37779E-03]
                        ]
                    ]
                ])

            }
        ]
    }),
    ('parser_test_data/d1s_mesh.m', {
        'date': '12/17/1814:06:18',
        'histories': 766606920.00,
        'title': 'Test of neutron flux calculations for reference.',
        'tallies': [
            {
                'name': 14, 'particle': 'PHOTON', 'geom': 'XYZ',
                'bins': {
                    'TIME': np.array([1.00E+00, 2.00E+00, 3.00E+00, 4.00E+00]),
                    'X': np.array([-5.00, -3.00, -1.00, 1.00, 3.00, 5.00]), 
                    'Y': np.array([-5.00, -3.00, -1.00, 1.00, 3.00, 5.00]),
                    'Z': np.array([-5.00, -3.00, -1.00, 1.00, 3.00, 5.00])
                },
                'result': np.array([
                    [
                        [
                            [8.92453E-08, 1.24887E-07, 1.56804E-07, 1.61620E-07, 1.34217E-07], 
                            [1.10391E-07, 1.77126E-07, 2.51215E-07, 2.62388E-07, 1.95196E-07], 
                            [1.23021E-07, 2.08444E-07, 3.18043E-07, 3.29838E-07, 2.29984E-07], 
                            [1.12524E-07, 1.76263E-07, 2.55344E-07, 2.64600E-07, 1.93915E-07], 
                            [8.96732E-08, 1.26210E-07, 1.57158E-07, 1.61266E-07, 1.35721E-07], 
                        ],
                        [
                            [1.13300E-07, 1.77945E-07, 2.46814E-07, 2.59300E-07, 1.93870E-07], 
                            [1.52459E-07, 3.06716E-07, 7.14723E-07, 7.19620E-07, 3.77493E-07], 
                            [1.72072E-07, 3.91336E-07, 1.46341E-06, 1.38556E-06, 5.48045E-07], 
                            [1.53821E-07, 3.07244E-07, 7.22951E-07, 7.25258E-07, 3.78795E-07], 
                            [1.11756E-07, 1.81490E-07, 2.53272E-07, 2.61106E-07, 1.94527E-07], 
                        ],
                        [
                            [1.25950E-07, 2.11558E-07, 3.16217E-07, 3.28060E-07, 2.33868E-07], 
                            [1.71856E-07, 3.96604E-07, 1.45958E-06, 1.38734E-06, 5.48853E-07], 
                            [1.96700E-07, 5.29040E-07, 2.73243E-06, 2.53523E-06, 8.33311E-07], 
                            [1.72650E-07, 3.96096E-07, 1.46463E-06, 1.38428E-06, 5.47845E-07], 
                            [1.24008E-07, 2.07453E-07, 3.19641E-07, 3.30529E-07, 2.32478E-07], 
                        ],
                        [
                            [1.13063E-07, 1.79890E-07, 2.54586E-07, 2.63512E-07, 1.95776E-07], 
                            [1.53673E-07, 3.07348E-07, 7.20651E-07, 7.27094E-07, 3.79922E-07], 
                            [1.70691E-07, 3.95201E-07, 1.46635E-06, 1.38597E-06, 5.47437E-07], 
                            [1.52316E-07, 3.08879E-07, 7.21570E-07, 7.23136E-07, 3.77177E-07], 
                            [1.13012E-07, 1.78413E-07, 2.50868E-07, 2.62647E-07, 1.93352E-07], 
                        ],
                        [
                            [9.06897E-08, 1.27240E-07, 1.56990E-07, 1.59999E-07, 1.32088E-07], 
                            [1.14633E-07, 1.79672E-07, 2.50255E-07, 2.63184E-07, 1.95092E-07], 
                            [1.22807E-07, 2.06967E-07, 3.18653E-07, 3.30730E-07, 2.31173E-07], 
                            [1.13695E-07, 1.81119E-07, 2.53129E-07, 2.64267E-07, 1.93465E-07], 
                            [8.95939E-08, 1.26791E-07, 1.58979E-07, 1.61257E-07, 1.33504E-07], 
                        ]
                    ],
                    [
                        [
                            [8.52058E-08, 1.19234E-07, 1.49707E-07, 1.54304E-07, 1.28142E-07], 
                            [1.05394E-07, 1.69109E-07, 2.39844E-07, 2.50512E-07, 1.86361E-07], 
                            [1.17453E-07, 1.99010E-07, 3.03648E-07, 3.14908E-07, 2.19574E-07], 
                            [1.07431E-07, 1.68284E-07, 2.43786E-07, 2.52623E-07, 1.85137E-07], 
                            [8.56144E-08, 1.20497E-07, 1.50045E-07, 1.53967E-07, 1.29578E-07], 
                        ],
                        [            
                            [1.08171E-07, 1.69891E-07, 2.35642E-07, 2.47564E-07, 1.85095E-07], 
                            [1.45558E-07, 2.92833E-07, 6.82372E-07, 6.87048E-07, 3.60407E-07], 
                            [1.64283E-07, 3.73623E-07, 1.39717E-06, 1.32284E-06, 5.23239E-07], 
                            [1.46858E-07, 2.93337E-07, 6.90228E-07, 6.92431E-07, 3.61649E-07], 
                            [1.06697E-07, 1.73275E-07, 2.41808E-07, 2.49288E-07, 1.85722E-07], 
                        ],
                        [           
                            [1.20249E-07, 2.01982E-07, 3.01904E-07, 3.13211E-07, 2.23282E-07], 
                            [1.64077E-07, 3.78653E-07, 1.39351E-06, 1.32454E-06, 5.24011E-07], 
                            [1.87796E-07, 5.05094E-07, 2.60875E-06, 2.42048E-06, 7.95593E-07], 
                            [1.64836E-07, 3.78167E-07, 1.39834E-06, 1.32162E-06, 5.23048E-07], 
                            [1.18395E-07, 1.98063E-07, 3.05173E-07, 3.15569E-07, 2.21955E-07], 
                        ],
                        [           
                            [1.07946E-07, 1.71748E-07, 2.43062E-07, 2.51585E-07, 1.86915E-07], 
                            [1.46717E-07, 2.93437E-07, 6.88032E-07, 6.94184E-07, 3.62726E-07], 
                            [1.62965E-07, 3.77313E-07, 1.39998E-06, 1.32324E-06, 5.22658E-07], 
                            [1.45422E-07, 2.94898E-07, 6.88910E-07, 6.90405E-07, 3.60105E-07], 
                            [1.07897E-07, 1.70338E-07, 2.39513E-07, 2.50759E-07, 1.84600E-07], 
                        ],
                        [           
                            [8.65848E-08, 1.21481E-07, 1.49884E-07, 1.52757E-07, 1.26109E-07], 
                            [1.09445E-07, 1.71540E-07, 2.38928E-07, 2.51272E-07, 1.86262E-07], 
                            [1.17249E-07, 1.97599E-07, 3.04230E-07, 3.15761E-07, 2.20709E-07], 
                            [1.08549E-07, 1.72921E-07, 2.41671E-07, 2.52306E-07, 1.84709E-07], 
                            [8.55387E-08, 1.21052E-07, 1.51783E-07, 1.53958E-07, 1.27461E-07], 
                        ]
                    ],
                    [
                        [
                            [5.61531E-08, 7.85788E-08, 9.86612E-08, 1.01691E-07, 8.44495E-08], 
                            [6.94578E-08, 1.11447E-07, 1.58064E-07, 1.65095E-07, 1.22817E-07], 
                            [7.74048E-08, 1.31153E-07, 2.00113E-07, 2.07534E-07, 1.44705E-07], 
                            [7.08003E-08, 1.10904E-07, 1.60662E-07, 1.66486E-07, 1.22011E-07], 
                            [5.64223E-08, 7.94112E-08, 9.88838E-08, 1.01468E-07, 8.53958E-08], 
                        ], [
                            [7.12881E-08, 1.11963E-07, 1.55295E-07, 1.63152E-07, 1.21983E-07], 
                            [9.59271E-08, 1.92985E-07, 4.49703E-07, 4.52785E-07, 2.37519E-07], 
                            [1.08267E-07, 2.46228E-07, 9.20774E-07, 8.71792E-07, 3.44830E-07], 
                            [9.67838E-08, 1.93318E-07, 4.54880E-07, 4.56332E-07, 2.38337E-07], 
                            [7.03165E-08, 1.14193E-07, 1.59358E-07, 1.64288E-07, 1.22396E-07], 
                        ], [
                            [7.92476E-08, 1.33112E-07, 1.98963E-07, 2.06415E-07, 1.47149E-07], 
                            [1.08132E-07, 2.49543E-07, 9.18364E-07, 8.72912E-07, 3.45338E-07], 
                            [1.23763E-07, 3.32872E-07, 1.71924E-06, 1.59516E-06, 5.24318E-07], 
                            [1.08631E-07, 2.49223E-07, 9.21543E-07, 8.70986E-07, 3.44704E-07], 
                            [7.80260E-08, 1.30529E-07, 2.01118E-07, 2.07969E-07, 1.46275E-07], 
                        ], [
                            [7.11394E-08, 1.13187E-07, 1.60185E-07, 1.65802E-07, 1.23182E-07], 
                            [9.66908E-08, 1.93383E-07, 4.53433E-07, 4.57487E-07, 2.39047E-07], 
                            [1.07398E-07, 2.48660E-07, 9.22626E-07, 8.72050E-07, 3.44447E-07], 
                            [9.58374E-08, 1.94346E-07, 4.54011E-07, 4.54997E-07, 2.37319E-07], 
                            [7.11071E-08, 1.12257E-07, 1.57846E-07, 1.65258E-07, 1.21657E-07], 
                        ], [
                            [5.70619E-08, 8.00594E-08, 9.87782E-08, 1.00671E-07, 8.31096E-08], 
                            [7.21273E-08, 1.13050E-07, 1.57460E-07, 1.65595E-07, 1.22752E-07], 
                            [7.72703E-08, 1.30224E-07, 2.00496E-07, 2.08095E-07, 1.45454E-07], 
                            [7.15368E-08, 1.13960E-07, 1.59268E-07, 1.66277E-07, 1.21728E-07], 
                            [5.63725E-08, 7.97769E-08, 1.00029E-07, 1.01463E-07, 8.40004E-08], 
                        ]

                    ],
                    [
                        [
                            [1.84625E-08, 2.58358E-08, 3.24387E-08, 3.34348E-08, 2.77660E-08], 
                            [2.28369E-08, 3.66426E-08, 5.19697E-08, 5.42812E-08, 4.03810E-08], 
                            [2.54498E-08, 4.31216E-08, 6.57947E-08, 6.82347E-08, 4.75775E-08], 
                            [2.32783E-08, 3.64640E-08, 5.28238E-08, 5.47386E-08, 4.01158E-08], 
                            [1.85510E-08, 2.61095E-08, 3.25118E-08, 3.33616E-08, 2.80771E-08], 
                        ],
                        [
                            [2.34387E-08, 3.68121E-08, 5.10592E-08, 5.36423E-08, 4.01065E-08], 
                            [3.15397E-08, 6.34514E-08, 1.47857E-07, 1.48870E-07, 7.80933E-08], 
                            [3.55971E-08, 8.09570E-08, 3.02740E-07, 2.86635E-07, 1.13376E-07], 
                            [3.18214E-08, 6.35606E-08, 1.49559E-07, 1.50037E-07, 7.83626E-08], 
                            [2.31192E-08, 3.75454E-08, 5.23952E-08, 5.40159E-08, 4.02425E-08], 
                        ],
                        [
                            [2.60557E-08, 4.37657E-08, 6.54168E-08, 6.78669E-08, 4.83810E-08], 
                            [3.55524E-08, 8.20468E-08, 3.01947E-07, 2.87003E-07, 1.13543E-07], 
                            [4.06919E-08, 1.09444E-07, 5.65266E-07, 5.24471E-07, 1.72390E-07], 
                            [3.57167E-08, 8.19417E-08, 3.02993E-07, 2.86370E-07, 1.13335E-07], 
                            [2.56540E-08, 4.29166E-08, 6.61251E-08, 6.83778E-08, 4.80934E-08], 
                        ],
                        [
                            [2.33898E-08, 3.72146E-08, 5.26670E-08, 5.45137E-08, 4.05009E-08], 
                            [3.17908E-08, 6.35822E-08, 1.49083E-07, 1.50416E-07, 7.85958E-08], 
                            [3.53113E-08, 8.17565E-08, 3.03349E-07, 2.86720E-07, 1.13250E-07], 
                            [3.15102E-08, 6.38988E-08, 1.49274E-07, 1.49598E-07, 7.80278E-08], 
                            [2.33792E-08, 3.69089E-08, 5.18979E-08, 5.43348E-08, 3.99993E-08], 
                        ],
                        [
                            [1.87613E-08, 2.63226E-08, 3.24771E-08, 3.30995E-08, 2.73255E-08], 
                            [2.37146E-08, 3.71695E-08, 5.17712E-08, 5.44458E-08, 4.03593E-08], 
                            [2.54056E-08, 4.28160E-08, 6.59208E-08, 6.84193E-08, 4.78235E-08], 
                            [2.35205E-08, 3.74687E-08, 5.23656E-08, 5.46699E-08, 4.00229E-08], 
                            [1.85346E-08, 2.62297E-08, 3.28884E-08, 3.33598E-08, 2.76184E-08], 
                        ]

                    ]
                ]),
                'error': np.array([
                    [
                        [
                            [0.01163, 0.00982, 0.00880, 0.00872, 0.00951], 
                            [0.01048, 0.00830, 0.00694, 0.00683, 0.00792], 
                            [0.00999, 0.00770, 0.00614, 0.00605, 0.00728], 
                            [0.01039, 0.00832, 0.00691, 0.00680, 0.00794], 
                            [0.01156, 0.00977, 0.00879, 0.00871, 0.00946], 
                        ],
                        [
                            [0.01039, 0.00829, 0.00701, 0.00687, 0.00795], 
                            [0.00896, 0.00634, 0.00404, 0.00410, 0.00573], 
                            [0.00845, 0.00557, 0.00274, 0.00288, 0.00471], 
                            [0.00891, 0.00634, 0.00402, 0.00408, 0.00571], 
                            [0.01043, 0.00824, 0.00692, 0.00685, 0.00792], 
                        ],
                        [
                            [0.00989, 0.00764, 0.00614, 0.00605, 0.00724], 
                            [0.00844, 0.00554, 0.00274, 0.00288, 0.00470], 
                            [0.00790, 0.00476, 0.00200, 0.00214, 0.00380], 
                            [0.00843, 0.00554, 0.00274, 0.00288, 0.00471], 
                            [0.01000, 0.00769, 0.00612, 0.00604, 0.00726], 
                        ],
                        [
                            [0.01036, 0.00824, 0.00691, 0.00682, 0.00790], 
                            [0.00892, 0.00632, 0.00403, 0.00407, 0.00571], 
                            [0.00848, 0.00555, 0.00274, 0.00288, 0.00472], 
                            [0.00897, 0.00631, 0.00402, 0.00408, 0.00572], 
                            [0.01039, 0.00827, 0.00696, 0.00682, 0.00794], 
                        ],
                        [
                            [0.01152, 0.00976, 0.00881, 0.00875, 0.00957], 
                            [0.01031, 0.00825, 0.00697, 0.00682, 0.00791], 
                            [0.01002, 0.00769, 0.00612, 0.00603, 0.00727], 
                            [0.01037, 0.00821, 0.00692, 0.00680, 0.00795], 
                            [0.01159, 0.00976, 0.00875, 0.00870, 0.00954], 
                        ]
                    ],
                    [
                        [
                            [0.01163, 0.00982, 0.00880, 0.00872, 0.00951], 
                            [0.01048, 0.00830, 0.00694, 0.00683, 0.00792], 
                            [0.00999, 0.00770, 0.00614, 0.00605, 0.00728], 
                            [0.01039, 0.00832, 0.00691, 0.00680, 0.00794], 
                            [0.01156, 0.00977, 0.00879, 0.00871, 0.00946], 
                        ],
                        [
                            [0.01039, 0.00829, 0.00701, 0.00687, 0.00795], 
                            [0.00896, 0.00634, 0.00404, 0.00410, 0.00573], 
                            [0.00845, 0.00557, 0.00274, 0.00288, 0.00471], 
                            [0.00891, 0.00634, 0.00402, 0.00408, 0.00571], 
                            [0.01043, 0.00824, 0.00692, 0.00685, 0.00792], 
                        ],
                        [
                            [0.00989, 0.00764, 0.00614, 0.00605, 0.00724], 
                            [0.00844, 0.00554, 0.00274, 0.00288, 0.00470], 
                            [0.00790, 0.00476, 0.00200, 0.00214, 0.00380], 
                            [0.00843, 0.00554, 0.00274, 0.00288, 0.00471], 
                            [0.01000, 0.00769, 0.00612, 0.00604, 0.00726], 
                        ],
                        [
                            [0.01036, 0.00824, 0.00691, 0.00682, 0.00790], 
                            [0.00892, 0.00632, 0.00403, 0.00407, 0.00571], 
                            [0.00848, 0.00555, 0.00274, 0.00288, 0.00472], 
                            [0.00897, 0.00631, 0.00402, 0.00408, 0.00572], 
                            [0.01039, 0.00827, 0.00696, 0.00682, 0.00794], 
                        ],
                        [
                            [0.01152, 0.00976, 0.00881, 0.00875, 0.00957], 
                            [0.01031, 0.00825, 0.00697, 0.00682, 0.00791], 
                            [0.01002, 0.00769, 0.00612, 0.00603, 0.00727], 
                            [0.01037, 0.00821, 0.00692, 0.00680, 0.00795], 
                            [0.01159, 0.00976, 0.00875, 0.00870, 0.00954], 
                        ]
                    ],
                    [
                        [
                            [0.01163, 0.00982, 0.00880, 0.00872, 0.00951], 
                            [0.01048, 0.00830, 0.00694, 0.00683, 0.00792], 
                            [0.00999, 0.00770, 0.00614, 0.00605, 0.00728], 
                            [0.01039, 0.00832, 0.00691, 0.00680, 0.00794], 
                            [0.01156, 0.00977, 0.00879, 0.00871, 0.00946], 
                        ],
                        [
                            [0.01039, 0.00829, 0.00701, 0.00687, 0.00795], 
                            [0.00896, 0.00634, 0.00404, 0.00410, 0.00573], 
                            [0.00845, 0.00557, 0.00274, 0.00288, 0.00471], 
                            [0.00891, 0.00634, 0.00402, 0.00408, 0.00571], 
                            [0.01043, 0.00824, 0.00692, 0.00685, 0.00792], 
                        ],
                        [
                            [0.00989, 0.00764, 0.00614, 0.00605, 0.00724], 
                            [0.00844, 0.00554, 0.00274, 0.00288, 0.00470], 
                            [0.00790, 0.00476, 0.00200, 0.00214, 0.00380], 
                            [0.00843, 0.00554, 0.00274, 0.00288, 0.00471], 
                            [0.01000, 0.00769, 0.00612, 0.00604, 0.00726], 
                        ],
                        [
                            [0.01036, 0.00824, 0.00691, 0.00682, 0.00790], 
                            [0.00892, 0.00632, 0.00403, 0.00407, 0.00571], 
                            [0.00848, 0.00555, 0.00274, 0.00288, 0.00472], 
                            [0.00897, 0.00631, 0.00402, 0.00408, 0.00572], 
                            [0.01039, 0.00827, 0.00696, 0.00682, 0.00794], 
                        ],
                        [
                            [0.01152, 0.00976, 0.00881, 0.00875, 0.00957], 
                            [0.01031, 0.00825, 0.00697, 0.00682, 0.00791], 
                            [0.01002, 0.00769, 0.00612, 0.00603, 0.00727], 
                            [0.01037, 0.00821, 0.00692, 0.00680, 0.00795], 
                            [0.01159, 0.00976, 0.00875, 0.00870, 0.00954], 
                        ]
                    ],
                    [
                        [
                            [0.01163, 0.00982, 0.00880, 0.00872, 0.00951], 
                            [0.01048, 0.00830, 0.00694, 0.00683, 0.00792], 
                            [0.00999, 0.00770, 0.00614, 0.00605, 0.00728], 
                            [0.01039, 0.00832, 0.00691, 0.00680, 0.00794], 
                            [0.01156, 0.00977, 0.00879, 0.00871, 0.00946], 
                        ],
                        [
                            [0.01039, 0.00829, 0.00701, 0.00687, 0.00795], 
                            [0.00896, 0.00634, 0.00404, 0.00410, 0.00573], 
                            [0.00845, 0.00557, 0.00274, 0.00288, 0.00471], 
                            [0.00891, 0.00634, 0.00402, 0.00408, 0.00571], 
                            [0.01043, 0.00824, 0.00692, 0.00685, 0.00792], 
                        ],
                        [
                            [0.00989, 0.00764, 0.00614, 0.00605, 0.00724], 
                            [0.00844, 0.00554, 0.00274, 0.00288, 0.00470], 
                            [0.00790, 0.00476, 0.00200, 0.00214, 0.00380], 
                            [0.00843, 0.00554, 0.00274, 0.00288, 0.00471], 
                            [0.01000, 0.00769, 0.00612, 0.00604, 0.00726], 
                        ],
                        [
                            [0.01036, 0.00824, 0.00691, 0.00682, 0.00790], 
                            [0.00892, 0.00632, 0.00403, 0.00407, 0.00571], 
                            [0.00848, 0.00555, 0.00274, 0.00288, 0.00472], 
                            [0.00897, 0.00631, 0.00402, 0.00408, 0.00572], 
                            [0.01039, 0.00827, 0.00696, 0.00682, 0.00794], 
                        ],
                        [
                            [0.01152, 0.00976, 0.00881, 0.00875, 0.00957], 
                            [0.01031, 0.00825, 0.00697, 0.00682, 0.00791], 
                            [0.01002, 0.00769, 0.00612, 0.00603, 0.00727], 
                            [0.01037, 0.00821, 0.00692, 0.00680, 0.00795], 
                            [0.01159, 0.00976, 0.00875, 0.00870, 0.00954]
                        ]
                    ]
               ])
            },
            {
                'name': 24, 'particle': 'PHOTON', 'geom': 'XYZ',
                'bins': {
                    'TIME': np.array([1.00E+00, 2.00E+00, 3.00E+00, 4.00E+00]),
                    'X': np.array([-5.00, -3.00, -1.00, 1.00, 3.00, 5.00]), 
                    'Y': np.array([-5.00, -3.00, -1.00, 1.00, 3.00, 5.00]),
                    'Z': np.array([-5.00, -3.00, -1.00, 1.00, 3.00, 5.00])
                },
                'result': np.array([
                    [
                        [
                            [1.65147E-09, 2.20534E-09, 2.70833E-09, 2.85064E-09, 2.34434E-09], 
                            [1.87587E-09, 3.02620E-09, 4.19142E-09, 4.65720E-09, 3.38723E-09], 
                            [2.12946E-09, 3.53725E-09, 5.39405E-09, 5.94829E-09, 3.99410E-09], 
                            [2.01459E-09, 2.98621E-09, 4.37829E-09, 4.67520E-09, 3.34176E-09], 
                            [1.60243E-09, 2.18338E-09, 2.62385E-09, 2.98216E-09, 2.40741E-09], 
                        ],
                        [
                            [1.94392E-09, 3.07505E-09, 4.24377E-09, 4.55821E-09, 3.41581E-09], 
                            [2.72289E-09, 5.29737E-09, 1.19796E-08, 1.29272E-08, 6.49600E-09], 
                            [2.98523E-09, 6.77768E-09, 2.47736E-08, 2.61942E-08, 9.54929E-09], 
                            [2.70996E-09, 5.35058E-09, 1.20420E-08, 1.30299E-08, 6.53883E-09], 
                            [1.94392E-09, 3.19938E-09, 4.35328E-09, 4.52467E-09, 3.34305E-09], 
                        ],
                        [
                            [2.15906E-09, 3.66856E-09, 5.37024E-09, 5.69757E-09, 4.18130E-09], 
                            [3.00804E-09, 6.73148E-09, 2.45272E-08, 2.61140E-08, 9.75044E-09], 
                            [3.49464E-09, 9.36023E-09, 4.96824E-08, 5.22206E-08, 1.50825E-08], 
                            [3.02436E-09, 6.84773E-09, 2.48619E-08, 2.61678E-08, 9.77084E-09], 
                            [2.17167E-09, 3.65755E-09, 5.46897E-09, 5.79175E-09, 4.26473E-09], 
                        ],
                        [
                            [1.94598E-09, 3.08064E-09, 4.28636E-09, 4.75630E-09, 3.45892E-09], 
                            [2.69612E-09, 5.43925E-09, 1.22050E-08, 1.31705E-08, 6.48057E-09], 
                            [3.10190E-09, 6.97084E-09, 2.51991E-08, 2.61734E-08, 9.48048E-09], 
                            [2.68530E-09, 5.32297E-09, 1.21761E-08, 1.30855E-08, 6.51168E-09], 
                            [2.01131E-09, 3.05422E-09, 4.24709E-09, 4.67083E-09, 3.42486E-09], 
                        ],
                        [
                            [1.61981E-09, 2.22746E-09, 2.64450E-09, 2.76347E-09, 2.37856E-09], 
                            [2.05575E-09, 3.15936E-09, 4.25688E-09, 4.73740E-09, 3.37773E-09], 
                            [2.17750E-09, 3.72092E-09, 5.44290E-09, 5.80180E-09, 3.98859E-09], 
                            [1.97145E-09, 3.16050E-09, 4.45975E-09, 4.60044E-09, 3.29786E-09], 
                            [1.55682E-09, 2.22582E-09, 2.84455E-09, 2.79964E-09, 2.29651E-09], 
                        ]
                    ],
                    [
                        [
                            [1.57672E-09, 2.10552E-09, 2.58574E-09, 2.72162E-09, 2.23823E-09], 
                            [1.79097E-09, 2.88923E-09, 4.00170E-09, 4.44640E-09, 3.23391E-09], 
                            [2.03308E-09, 3.37714E-09, 5.14990E-09, 5.67906E-09, 3.81331E-09], 
                            [1.92340E-09, 2.85104E-09, 4.18011E-09, 4.46359E-09, 3.19051E-09], 
                            [1.52990E-09, 2.08456E-09, 2.50509E-09, 2.84717E-09, 2.29844E-09], 
                        ],
                        [
                            [1.85593E-09, 2.93586E-09, 4.05168E-09, 4.35189E-09, 3.26120E-09], 
                            [2.59964E-09, 5.05759E-09, 1.14374E-08, 1.23421E-08, 6.20197E-09], 
                            [2.85011E-09, 6.47090E-09, 2.36522E-08, 2.50086E-08, 9.11706E-09], 
                            [2.58730E-09, 5.10840E-09, 1.14970E-08, 1.24401E-08, 6.24287E-09], 
                            [1.85593E-09, 3.05457E-09, 4.15624E-09, 4.31987E-09, 3.19173E-09], 
                        ],
                        [
                            [2.06134E-09, 3.50251E-09, 5.12716E-09, 5.43968E-09, 3.99204E-09], 
                            [2.87189E-09, 6.42679E-09, 2.34170E-08, 2.49320E-08, 9.30911E-09], 
                            [3.33646E-09, 8.93656E-09, 4.74336E-08, 4.98570E-08, 1.43999E-08], 
                            [2.88747E-09, 6.53778E-09, 2.37365E-08, 2.49834E-08, 9.32858E-09], 
                            [2.07337E-09, 3.49200E-09, 5.22143E-09, 5.52960E-09, 4.07170E-09], 
                        ],
                        [
                            [1.85790E-09, 2.94120E-09, 4.09235E-09, 4.54102E-09, 3.30236E-09], 
                            [2.57409E-09, 5.19305E-09, 1.16525E-08, 1.25744E-08, 6.18724E-09], 
                            [2.96150E-09, 6.65532E-09, 2.40585E-08, 2.49887E-08, 9.05137E-09], 
                            [2.56376E-09, 5.08204E-09, 1.16250E-08, 1.24932E-08, 6.21694E-09], 
                            [1.92028E-09, 2.91597E-09, 4.05485E-09, 4.45941E-09, 3.26985E-09], 
                        ],
                        [
                            [1.54650E-09, 2.12664E-09, 2.52480E-09, 2.63839E-09, 2.27090E-09], 
                            [1.96270E-09, 3.01635E-09, 4.06420E-09, 4.52297E-09, 3.22484E-09], 
                            [2.07894E-09, 3.55250E-09, 5.19654E-09, 5.53920E-09, 3.80806E-09], 
                            [1.88221E-09, 3.01744E-09, 4.25789E-09, 4.39221E-09, 3.14859E-09], 
                            [1.48635E-09, 2.12507E-09, 2.71580E-09, 2.67292E-09, 2.19256E-09], 
                        ]
                    ],
                    [
                        [
                            [1.03910E-09, 1.38760E-09, 1.70408E-09, 1.79362E-09, 1.47506E-09], 
                            [1.18030E-09, 1.90408E-09, 2.63724E-09, 2.93031E-09, 2.13124E-09], 
                            [1.33986E-09, 2.22563E-09, 3.39394E-09, 3.74266E-09, 2.51308E-09], 
                            [1.26758E-09, 1.87892E-09, 2.75481E-09, 2.94163E-09, 2.10264E-09], 
                            [1.00825E-09, 1.37378E-09, 1.65092E-09, 1.87637E-09, 1.51474E-09], 
                        ],
                        [
                            [1.22311E-09, 1.93482E-09, 2.67018E-09, 2.86802E-09, 2.14923E-09], 
                            [1.71324E-09, 3.33310E-09, 7.53755E-09, 8.13377E-09, 4.08728E-09], 
                            [1.87831E-09, 4.26451E-09, 1.55875E-08, 1.64814E-08, 6.00841E-09], 
                            [1.70510E-09, 3.36658E-09, 7.57682E-09, 8.19842E-09, 4.11423E-09], 
                            [1.22311E-09, 2.01305E-09, 2.73908E-09, 2.84692E-09, 2.10344E-09], 
                        ],
                        [
                            [1.35848E-09, 2.30826E-09, 3.37895E-09, 3.58491E-09, 2.63087E-09], 
                            [1.89266E-09, 4.23544E-09, 1.54325E-08, 1.64309E-08, 6.13497E-09], 
                            [2.19883E-09, 5.88945E-09, 3.12601E-08, 3.28572E-08, 9.48992E-09], 
                            [1.90293E-09, 4.30858E-09, 1.56431E-08, 1.64648E-08, 6.14781E-09], 
                            [1.36641E-09, 2.30133E-09, 3.44107E-09, 3.64416E-09, 2.68337E-09], 
                        ],
                        [
                            [1.22441E-09, 1.93834E-09, 2.69698E-09, 2.99266E-09, 2.17635E-09], 
                            [1.69640E-09, 3.42237E-09, 7.67935E-09, 8.28690E-09, 4.07757E-09], 
                            [1.95172E-09, 4.38605E-09, 1.58552E-08, 1.64683E-08, 5.96511E-09], 
                            [1.68959E-09, 3.34921E-09, 7.66122E-09, 8.23337E-09, 4.09714E-09], 
                            [1.26552E-09, 1.92171E-09, 2.67226E-09, 2.93888E-09, 2.15492E-09], 
                        ],
                        [
                            [1.01919E-09, 1.40152E-09, 1.66392E-09, 1.73877E-09, 1.49659E-09], 
                            [1.29348E-09, 1.98786E-09, 2.67842E-09, 2.98077E-09, 2.12526E-09], 
                            [1.37008E-09, 2.34120E-09, 3.42467E-09, 3.65049E-09, 2.50962E-09], 
                            [1.24043E-09, 1.98858E-09, 2.80607E-09, 2.89459E-09, 2.07501E-09], 
                            [9.79551E-10, 1.40048E-09, 1.78979E-09, 1.76153E-09, 1.44496E-09], 
                        ]
                    ],
                    [
                        [
                            [3.41644E-10, 4.56226E-10, 5.60282E-10, 5.89722E-10, 4.84982E-10], 
                            [3.88068E-10, 6.26040E-10, 8.67093E-10, 9.63451E-10, 7.00727E-10], 
                            [4.40529E-10, 7.31762E-10, 1.11589E-09, 1.23054E-09, 8.26272E-10], 
                            [4.16765E-10, 6.17767E-10, 9.05751E-10, 9.67174E-10, 6.91322E-10], 
                            [3.31500E-10, 4.51684E-10, 5.42804E-10, 6.16929E-10, 4.98029E-10], 
                        ],
                        [
                            [4.02144E-10, 6.36145E-10, 8.77922E-10, 9.42972E-10, 7.06641E-10], 
                            [5.63293E-10, 1.09588E-09, 2.47826E-09, 2.67429E-09, 1.34385E-09], 
                            [6.17565E-10, 1.40212E-09, 5.12499E-09, 5.41889E-09, 1.97549E-09], 
                            [5.60618E-10, 1.10689E-09, 2.49117E-09, 2.69554E-09, 1.35271E-09], 
                            [4.02145E-10, 6.61867E-10, 9.00578E-10, 9.36034E-10, 6.91588E-10], 
                        ],
                        [
                            [4.46653E-10, 7.58928E-10, 1.11096E-09, 1.17868E-09, 8.64999E-10], 
                            [6.22284E-10, 1.39256E-09, 5.07403E-09, 5.40229E-09, 2.01711E-09], 
                            [7.22948E-10, 1.93638E-09, 1.02780E-08, 1.08031E-08, 3.12017E-09], 
                            [6.25660E-10, 1.41661E-09, 5.14326E-09, 5.41342E-09, 2.02133E-09], 
                            [4.49260E-10, 7.56649E-10, 1.13138E-09, 1.19816E-09, 8.82259E-10], 
                        ],
                        [
                            [4.02572E-10, 6.37303E-10, 8.86734E-10, 9.83953E-10, 7.15558E-10], 
                            [5.57756E-10, 1.12524E-09, 2.52488E-09, 2.72464E-09, 1.34066E-09], 
                            [6.41702E-10, 1.44208E-09, 5.21302E-09, 5.41458E-09, 1.96126E-09], 
                            [5.55517E-10, 1.10118E-09, 2.51892E-09, 2.70704E-09, 1.34709E-09], 
                            [4.16087E-10, 6.31836E-10, 8.78609E-10, 9.66270E-10, 7.08513E-10], 
                        ],
                        [
                            [3.35096E-10, 4.60803E-10, 5.47077E-10, 5.71689E-10, 4.92060E-10], 
                            [4.25281E-10, 6.53587E-10, 8.80634E-10, 9.80042E-10, 6.98762E-10], 
                            [4.50466E-10, 7.69759E-10, 1.12599E-09, 1.20024E-09, 8.25133E-10], 
                            [4.07840E-10, 6.53823E-10, 9.22604E-10, 9.51708E-10, 6.82239E-10], 
                            [3.22065E-10, 4.60462E-10, 5.88462E-10, 5.79171E-10, 4.75086E-10], 
                        ]
                    ]
                ]),
                'error': np.array([
                    [
                        [
                            [0.02769, 0.02344, 0.02086, 0.02066, 0.02252], 
                            [0.02455, 0.01982, 0.01656, 0.01622, 0.01887], 
                            [0.02392, 0.01822, 0.01467, 0.01433, 0.01737], 
                            [0.02488, 0.01984, 0.01652, 0.01600, 0.01894], 
                            [0.02795, 0.02368, 0.02132, 0.02059, 0.02244], 
                        ],
                        [        
                            [0.02496, 0.01987, 0.01686, 0.01638, 0.01902], 
                            [0.02155, 0.01520, 0.00979, 0.00969, 0.01351], 
                            [0.02027, 0.01338, 0.00677, 0.00697, 0.01117], 
                            [0.02127, 0.01524, 0.00974, 0.00973, 0.01349], 
                            [0.02470, 0.01980, 0.01666, 0.01634, 0.01877], 
                        ],
                        [       
                            [0.02383, 0.01835, 0.01471, 0.01436, 0.01720], 
                            [0.02020, 0.01335, 0.00679, 0.00697, 0.01124], 
                            [0.01885, 0.01144, 0.00505, 0.00525, 0.00902], 
                            [0.02000, 0.01323, 0.00680, 0.00695, 0.01115], 
                            [0.02396, 0.01851, 0.01466, 0.01437, 0.01717], 
                        ],
                        [       
                            [0.02500, 0.01971, 0.01656, 0.01619, 0.01885], 
                            [0.02141, 0.01526, 0.00976, 0.00965, 0.01355], 
                            [0.02036, 0.01323, 0.00678, 0.00699, 0.01120], 
                            [0.02127, 0.01504, 0.00977, 0.00970, 0.01358], 
                            [0.02482, 0.01975, 0.01660, 0.01626, 0.01886]
                        ], 
                        [       
                            [0.02746, 0.02338, 0.02101, 0.02057, 0.02267], 
                            [0.02456, 0.01987, 0.01668, 0.01618, 0.01873], 
                            [0.02379, 0.01838, 0.01470, 0.01432, 0.01731], 
                            [0.02469, 0.01957, 0.01661, 0.01615, 0.01914], 
                            [0.02757, 0.02335, 0.02111, 0.02090, 0.02224]
                        ]
                    ],
                    [
                        [       
                            [0.02769, 0.02344, 0.02086, 0.02066, 0.02252], 
                            [0.02455, 0.01982, 0.01656, 0.01622, 0.01887], 
                            [0.02392, 0.01822, 0.01467, 0.01433, 0.01737], 
                            [0.02488, 0.01984, 0.01652, 0.01600, 0.01894], 
                            [0.02795, 0.02368, 0.02132, 0.02059, 0.02244]
                        ], 
                        [       
                            [0.02496, 0.01987, 0.01686, 0.01638, 0.01902], 
                            [0.02155, 0.01520, 0.00979, 0.00969, 0.01351], 
                            [0.02027, 0.01338, 0.00677, 0.00697, 0.01117], 
                            [0.02127, 0.01524, 0.00974, 0.00973, 0.01349], 
                            [0.02470, 0.01980, 0.01666, 0.01634, 0.01877]
                        ], 
                        [       
                            [0.02383, 0.01835, 0.01471, 0.01436, 0.01720], 
                            [0.02020, 0.01335, 0.00679, 0.00697, 0.01124], 
                            [0.01885, 0.01144, 0.00505, 0.00525, 0.00902], 
                            [0.02000, 0.01323, 0.00680, 0.00695, 0.01115], 
                            [0.02396, 0.01851, 0.01466, 0.01437, 0.01717]
                        ], 
                        [       
                            [0.02500, 0.01971, 0.01656, 0.01619, 0.01885], 
                            [0.02141, 0.01526, 0.00976, 0.00965, 0.01355], 
                            [0.02036, 0.01323, 0.00678, 0.00699, 0.01120], 
                            [0.02127, 0.01504, 0.00977, 0.00970, 0.01358], 
                            [0.02482, 0.01975, 0.01660, 0.01626, 0.01886]
                        ], 
                        [       
                            [0.02746, 0.02338, 0.02101, 0.02057, 0.02267], 
                            [0.02456, 0.01987, 0.01668, 0.01618, 0.01873], 
                            [0.02379, 0.01838, 0.01470, 0.01432, 0.01731], 
                            [0.02469, 0.01957, 0.01661, 0.01615, 0.01914], 
                            [0.02757, 0.02335, 0.02111, 0.02090, 0.02224]
                        ]
                    ],
                    [
                        [       
                            [0.02769, 0.02344, 0.02086, 0.02066, 0.02252], 
                            [0.02455, 0.01982, 0.01656, 0.01622, 0.01887], 
                            [0.02392, 0.01822, 0.01467, 0.01433, 0.01737], 
                            [0.02488, 0.01984, 0.01652, 0.01600, 0.01894], 
                            [0.02795, 0.02368, 0.02132, 0.02059, 0.02244]
                        ], 
                        [       
                            [0.02496, 0.01987, 0.01686, 0.01638, 0.01902], 
                            [0.02155, 0.01520, 0.00979, 0.00969, 0.01351], 
                            [0.02027, 0.01338, 0.00677, 0.00697, 0.01117], 
                            [0.02127, 0.01524, 0.00974, 0.00973, 0.01349], 
                            [0.02470, 0.01980, 0.01666, 0.01634, 0.01877]
                        ], 
                        [       
                            [0.02383, 0.01835, 0.01471, 0.01436, 0.01720], 
                            [0.02020, 0.01335, 0.00679, 0.00697, 0.01124], 
                            [0.01885, 0.01144, 0.00505, 0.00525, 0.00902], 
                            [0.02000, 0.01323, 0.00680, 0.00695, 0.01115], 
                            [0.02396, 0.01851, 0.01466, 0.01437, 0.01717]
                        ], 
                        [       
                            [0.02500, 0.01971, 0.01656, 0.01619, 0.01885], 
                            [0.02141, 0.01526, 0.00976, 0.00965, 0.01355], 
                            [0.02036, 0.01323, 0.00678, 0.00699, 0.01120], 
                            [0.02127, 0.01504, 0.00977, 0.00970, 0.01358], 
                            [0.02482, 0.01975, 0.01660, 0.01626, 0.01886]
                        ], 
                        [       
                            [0.02746, 0.02338, 0.02101, 0.02057, 0.02267], 
                            [0.02456, 0.01987, 0.01668, 0.01618, 0.01873], 
                            [0.02379, 0.01838, 0.01470, 0.01432, 0.01731], 
                            [0.02469, 0.01957, 0.01661, 0.01615, 0.01914], 
                            [0.02757, 0.02335, 0.02111, 0.02090, 0.02224]
                        ]
                    ],
                    [
                        [       
                            [0.02769, 0.02344, 0.02086, 0.02066, 0.02252], 
                            [0.02455, 0.01982, 0.01656, 0.01622, 0.01887], 
                            [0.02392, 0.01822, 0.01467, 0.01433, 0.01737], 
                            [0.02488, 0.01984, 0.01652, 0.01600, 0.01894], 
                            [0.02795, 0.02368, 0.02132, 0.02059, 0.02244]
                        ], 
                        [       
                            [0.02496, 0.01987, 0.01686, 0.01638, 0.01902], 
                            [0.02155, 0.01520, 0.00979, 0.00969, 0.01351], 
                            [0.02027, 0.01338, 0.00677, 0.00697, 0.01117], 
                            [0.02127, 0.01524, 0.00974, 0.00973, 0.01349], 
                            [0.02470, 0.01980, 0.01666, 0.01634, 0.01877]
                        ], 
                        [       
                            [0.02383, 0.01835, 0.01471, 0.01436, 0.01720], 
                            [0.02020, 0.01335, 0.00679, 0.00697, 0.01124], 
                            [0.01885, 0.01144, 0.00505, 0.00525, 0.00902], 
                            [0.02000, 0.01323, 0.00680, 0.00695, 0.01115], 
                            [0.02396, 0.01851, 0.01466, 0.01437, 0.01717]
                        ], 
                        [       
                            [0.02500, 0.01971, 0.01656, 0.01619, 0.01885], 
                            [0.02141, 0.01526, 0.00976, 0.00965, 0.01355], 
                            [0.02036, 0.01323, 0.00678, 0.00699, 0.01120], 
                            [0.02127, 0.01504, 0.00977, 0.00970, 0.01358], 
                            [0.02482, 0.01975, 0.01660, 0.01626, 0.01886]
                        ], 
                        [       
                            [0.02746, 0.02338, 0.02101, 0.02057, 0.02267], 
                            [0.02456, 0.01987, 0.01668, 0.01618, 0.01873], 
                            [0.02379, 0.01838, 0.01470, 0.01432, 0.01731], 
                            [0.02469, 0.01957, 0.01661, 0.01615, 0.01914], 
                            [0.02757, 0.02335, 0.02111, 0.02090, 0.02224]
                        ]
                    ]
                ])
            }
        ]
    }),
    ('parser_test_data/fmesh3.m', {
        'date': '05/24/1812:21:45',
        'histories': 10000000.00,
        'title': 'fmesh test',
        'tallies': [
            {
                'name': 14, 'particle': 'NEUTRON', 'geom': 'XYZ',
                'bins': {
                    'ENERGY': np.array([0.00E+00, 1.00E+36]),
                    'X': np.array([-3.00, -1.00, 1.00, 3.00]), 'Y': np.array([-3.00, -1.00, 1.00, 3.00, 5.00]),
                    'Z': np.array([-4.00, -1.60, 0.80, 3.20, 5.60, 8.00])
                },
                'result': np.array([
                    [
                        [
                            [7.18813E-03, 3.06754E-03, 1.46764E-03, 7.66660E-04, 4.03778E-04],
                            [1.06634E-02, 3.67344E-03, 1.64976E-03, 8.36825E-04, 4.28819E-04],
                            [7.17257E-03, 3.06150E-03, 1.47022E-03, 7.71489E-04, 3.98268E-04],
                            [3.47599E-03, 1.93182E-03, 1.04730E-03, 5.73177E-04, 3.11514E-04]
                        ],
                        [
                            [1.06743E-02, 3.67618E-03, 1.64985E-03, 8.36179E-04, 4.36976E-04],
                            [2.01953E-02, 4.44305E-03, 1.83404E-03, 9.03003E-04, 4.60324E-04],
                            [1.06720E-02, 3.66319E-03, 1.63652E-03, 8.30197E-04, 4.30752E-04],
                            [4.24826E-03, 2.24115E-03, 1.18622E-03, 6.40838E-04, 3.43042E-04]
                        ],
                        [
                            [7.21022E-03, 3.08980E-03, 1.48035E-03, 7.68615E-04, 4.02710E-04],
                            [1.06646E-02, 3.66923E-03, 1.63603E-03, 8.31973E-04, 4.26487E-04],
                            [7.19676E-03, 3.07813E-03, 1.47782E-03, 7.74412E-04, 4.05770E-04],
                            [3.47633E-03, 1.93512E-03, 1.05235E-03, 5.78607E-04, 3.11651E-04]
                        ]
                    ]
                ]),
                'error': np.array([
                    [
                        [
                            [0.00169, 0.00264, 0.00386, 0.00532, 0.00722],
                            [0.00137, 0.00243, 0.00366, 0.00515, 0.00705],
                            [0.00169, 0.00264, 0.00384, 0.00532, 0.00727],
                            [0.00233, 0.00319, 0.00437, 0.00593, 0.00800]
                        ],
                        [
                            [0.00137, 0.00243, 0.00367, 0.00514, 0.00698],
                            [0.00093, 0.00221, 0.00350, 0.00497, 0.00682],
                            [0.00137, 0.00243, 0.00368, 0.00517, 0.00703],
                            [0.00212, 0.00302, 0.00419, 0.00572, 0.00774]
                        ],
                        [
                            [0.00169, 0.00263, 0.00383, 0.00534, 0.00725],
                            [0.00137, 0.00243, 0.00368, 0.00516, 0.00705],
                            [0.00169, 0.00264, 0.00384, 0.00531, 0.00720],
                            [0.00233, 0.00319, 0.00436, 0.00589, 0.00800]
                        ]
                    ]
                ])
            },
            {
                'name': 24, 'particle': 'PHOTON', 'geom': 'CYL',
                'origin': np.array([-3.00E+00, -3.00E+00, -4.00E+00]), 'axis': np.array([0.000E+00, 0.000E+00, 1.000E+00]),
                'bins': {
                    'ENERGY': np.array([0.00E+00, 6.67E+00, 1.33E+01, 2.00E+01]),
                    'R': np.array([0.00, 1.00, 2.00, 3.00]), 'Z': np.array([0.00, 1.25, 2.50, 3.75, 5.00]),
                    'THETA': np.array([0.000, 0.200, 0.400, 0.600, 0.800, 1.000])
                },
                'result': np.array([
                    [
                        [
                            [4.26676E-04, 3.60929E-04, 2.51881E-04, 2.35336E-04, 3.27815E-04],
                            [4.17376E-04, 3.74891E-04, 2.65612E-04, 2.47303E-04, 3.41729E-04],
                            [3.52530E-04, 3.21725E-04, 2.39415E-04, 2.22406E-04, 2.87633E-04],
                            [2.91647E-04, 2.64957E-04, 2.03075E-04, 1.88207E-04, 2.53038E-04]
                        ],
                        [
                            [5.72802E-04, 4.02577E-04, 1.62808E-04, 1.47284E-04, 3.22879E-04],
                            [5.32281E-04, 3.90955E-04, 1.77012E-04, 1.56642E-04, 3.20700E-04],
                            [4.34871E-04, 3.36510E-04, 1.64430E-04, 1.47865E-04, 2.81179E-04],
                            [3.39817E-04, 2.74729E-04, 1.44850E-04, 1.30022E-04, 2.32783E-04]
                        ],
                        [
                            [7.68761E-04, 4.02569E-04, 1.09868E-04, 9.83327E-05, 2.85524E-04],
                            [6.74185E-04, 3.99908E-04, 1.23025E-04, 1.08080E-04, 2.97412E-04],
                            [5.11027E-04, 3.42010E-04, 1.15448E-04, 1.05403E-04, 2.57364E-04],
                            [3.89689E-04, 2.67553E-04, 1.05158E-04, 9.46154E-05, 2.10578E-04]
                        ]
                    ],
                    [
                        [
                            [0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [1.24150E-07, 5.58994E-09, 1.24827E-07, 0.00000E+00, 0.00000E+00],
                            [5.57853E-09, 2.64984E-08, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00]
                        ],
                        [
                            [3.31041E-08, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [4.24567E-08, 4.34742E-08, 4.24567E-08, 0.00000E+00, 0.00000E+00],
                            [0.00000E+00, 1.51344E-08, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [9.82692E-09, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00]
                        ],
                        [
                            [3.44266E-08, 3.21212E-08, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [4.55038E-08, 3.04180E-08, 2.54702E-08, 0.00000E+00, 0.00000E+00],
                            [3.03939E-09, 3.13872E-08, 4.05251E-09, 0.00000E+00, 0.00000E+00],
                            [2.19894E-09, 4.43644E-09, 3.78085E-08, 0.00000E+00, 0.00000E+00]
                        ]
                    ],
                    [
                        [
                            [1.61383E-07, 2.45465E-07, 4.80361E-08, 2.86873E-08, 1.36531E-07],
                            [0.00000E+00, 0.00000E+00, 6.11344E-08, 6.62558E-08, 6.94414E-08],
                            [1.79183E-07, 1.83093E-07, 1.26324E-07, 1.10180E-07, 9.84652E-08],
                            [1.15801E-07, 7.11787E-08, 9.61169E-08, 6.27373E-08, 9.09577E-08]
                        ],
                        [
                            [3.33988E-07, 3.02723E-07, 1.00276E-07, 4.54345E-08, 1.28529E-07],
                            [1.05911E-07, 0.00000E+00, 6.03481E-08, 6.20807E-08, 6.65379E-08],
                            [1.03901E-07, 1.16357E-07, 1.77282E-07, 6.12241E-08, 1.68246E-07],
                            [6.42099E-08, 5.82408E-08, 3.50897E-08, 1.41587E-07, 6.02894E-08]
                        ],
                        [
                            [4.35790E-07, 5.28413E-08, 6.09709E-08, 2.61146E-08, 2.55932E-07],
                            [1.36592E-07, 2.03173E-07, 6.40422E-08, 2.55531E-08, 1.59063E-07],
                            [2.33628E-07, 3.94338E-07, 1.14898E-07, 1.76035E-08, 9.71856E-08],
                            [2.10624E-07, 1.56979E-07, 7.03514E-08, 4.10227E-08, 1.43260E-07]
                        ]
                    ]
                ]),
                'error': np.array([
                    [
                        [
                            [1.51165E-02, 1.65362E-02, 1.95638E-02, 2.00471E-02, 1.74294E-02],
                            [1.54432E-02, 1.65796E-02, 1.93011E-02, 1.98625E-02, 1.73169E-02],
                            [1.70852E-02, 1.80477E-02, 2.04493E-02, 2.12808E-02, 1.90279E-02],
                            [1.91640E-02, 2.00755E-02, 2.24192E-02, 2.31940E-02, 2.06925E-02]
                        ],
                        [
                            [9.09560E-03, 1.13354E-02, 1.68719E-02, 1.73306E-02, 1.27127E-02],
                            [9.56337E-03, 1.15957E-02, 1.62495E-02, 1.68587E-02, 1.28723E-02],
                            [1.07933E-02, 1.25307E-02, 1.69082E-02, 1.73571E-02, 1.37630E-02],
                            [1.21292E-02, 1.38951E-02, 1.80609E-02, 1.84843E-02, 1.50679E-02]
                        ],
                        [
                            [6.46985E-03, 9.39907E-03, 1.63465E-02, 1.65062E-02, 1.11913E-02],
                            [7.10451E-03, 9.57794E-03, 1.55160E-02, 1.59039E-02, 1.11509E-02],
                            [8.19050E-03, 1.02979E-02, 1.59845E-02, 1.59556E-02, 1.17764E-02],
                            [9.40942E-03, 1.15396E-02, 1.66056E-02, 1.68655E-02, 1.28912E-02]
                        ]
                    ],
                    [
                        [
                            [0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [1.00000E+00, 1.00000E+00, 1.00000E+00, 0.00000E+00, 0.00000E+00],
                            [1.00000E+00, 1.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00]
                        ],
                        [
                            [1.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [1.00000E+00, 1.00000E+00, 1.00000E+00, 0.00000E+00, 0.00000E+00],
                            [0.00000E+00, 1.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [1.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00]
                        ],
                        [
                            [1.00000E+00, 1.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [7.94765E-01, 1.00000E+00, 1.00000E+00, 0.00000E+00, 0.00000E+00],
                            [1.00000E+00, 1.00000E+00, 1.00000E+00, 0.00000E+00, 0.00000E+00],
                            [1.00000E+00, 1.00000E+00, 1.00000E+00, 0.00000E+00, 0.00000E+00]
                        ]
                    ],
                    [
                        [
                            [7.13649E-01, 7.08199E-01, 7.92007E-01, 1.00000E+00, 7.98367E-01],
                            [0.00000E+00, 0.00000E+00, 1.00000E+00, 1.00000E+00, 1.00000E+00],
                            [7.37976E-01, 7.34192E-01, 8.08038E-01, 1.00000E+00, 9.90367E-01],
                            [1.00000E+00, 1.00000E+00, 1.00000E+00, 7.11428E-01, 1.00000E+00]
                        ],
                        [
                            [3.73939E-01, 4.35674E-01, 6.39167E-01, 1.00000E+00, 6.13512E-01],
                            [7.09827E-01, 0.00000E+00, 8.65521E-01, 8.21311E-01, 7.07324E-01],
                            [7.06117E-01, 6.58996E-01, 5.87822E-01, 8.92465E-01, 5.85102E-01],
                            [5.99586E-01, 7.93568E-01, 1.00000E+00, 5.39828E-01, 1.00000E+00]
                        ],
                        [
                            [2.74749E-01, 6.07463E-01, 7.11666E-01, 1.00000E+00, 3.38896E-01],
                            [4.70422E-01, 4.07795E-01, 7.12197E-01, 1.00000E+00, 4.89133E-01],
                            [4.69333E-01, 3.23265E-01, 4.92014E-01, 8.57334E-01, 5.38949E-01],
                            [3.71867E-01, 4.36175E-01, 7.21109E-01, 7.29208E-01, 4.55335E-01]
                        ]
                    ]
                ])
            }
        ]
    }),
    ('parser_test_data/fmesh2.m', {
        'date': '05/24/1812:21:45',
        'histories': 10000000.00,
        'title': 'fmesh test',
        'tallies': [
            {
                'name': 24, 'particle': 'PHOTON', 'geom': 'CYL',
                'origin': np.array([-3.00E+00, -3.00E+00, -4.00E+00]), 'axis': np.array([0.000E+00, 0.000E+00, 1.000E+00]),
                'bins': {
                    'ENERGY': np.array([0.00E+00, 6.67E+00, 1.33E+01, 2.00E+01]),
                    'R': np.array([0.00, 1.00, 2.00, 3.00]), 'Z': np.array([0.00, 1.25, 2.50, 3.75, 5.00]),
                    'THETA': np.array([0.000, 0.200, 0.400, 0.600, 0.800, 1.000])
                },
                'result': np.array([
                    [
                        [
                            [4.26676E-04, 3.60929E-04, 2.51881E-04, 2.35336E-04, 3.27815E-04],
                            [4.17376E-04, 3.74891E-04, 2.65612E-04, 2.47303E-04, 3.41729E-04],
                            [3.52530E-04, 3.21725E-04, 2.39415E-04, 2.22406E-04, 2.87633E-04],
                            [2.91647E-04, 2.64957E-04, 2.03075E-04, 1.88207E-04, 2.53038E-04]
                        ],
                        [
                            [5.72802E-04, 4.02577E-04, 1.62808E-04, 1.47284E-04, 3.22879E-04],
                            [5.32281E-04, 3.90955E-04, 1.77012E-04, 1.56642E-04, 3.20700E-04],
                            [4.34871E-04, 3.36510E-04, 1.64430E-04, 1.47865E-04, 2.81179E-04],
                            [3.39817E-04, 2.74729E-04, 1.44850E-04, 1.30022E-04, 2.32783E-04]
                        ],
                        [
                            [7.68761E-04, 4.02569E-04, 1.09868E-04, 9.83327E-05, 2.85524E-04],
                            [6.74185E-04, 3.99908E-04, 1.23025E-04, 1.08080E-04, 2.97412E-04],
                            [5.11027E-04, 3.42010E-04, 1.15448E-04, 1.05403E-04, 2.57364E-04],
                            [3.89689E-04, 2.67553E-04, 1.05158E-04, 9.46154E-05, 2.10578E-04]
                        ]
                    ],
                    [
                        [
                            [0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [1.24150E-07, 5.58994E-09, 1.24827E-07, 0.00000E+00, 0.00000E+00],
                            [5.57853E-09, 2.64984E-08, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00]
                        ],
                        [
                            [3.31041E-08, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [4.24567E-08, 4.34742E-08, 4.24567E-08, 0.00000E+00, 0.00000E+00],
                            [0.00000E+00, 1.51344E-08, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [9.82692E-09, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00]
                        ],
                        [
                            [3.44266E-08, 3.21212E-08, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [4.55038E-08, 3.04180E-08, 2.54702E-08, 0.00000E+00, 0.00000E+00],
                            [3.03939E-09, 3.13872E-08, 4.05251E-09, 0.00000E+00, 0.00000E+00],
                            [2.19894E-09, 4.43644E-09, 3.78085E-08, 0.00000E+00, 0.00000E+00]
                        ]
                    ],
                    [
                        [
                            [1.61383E-07, 2.45465E-07, 4.80361E-08, 2.86873E-08, 1.36531E-07],
                            [0.00000E+00, 0.00000E+00, 6.11344E-08, 6.62558E-08, 6.94414E-08],
                            [1.79183E-07, 1.83093E-07, 1.26324E-07, 1.10180E-07, 9.84652E-08],
                            [1.15801E-07, 7.11787E-08, 9.61169E-08, 6.27373E-08, 9.09577E-08]
                        ],
                        [
                            [3.33988E-07, 3.02723E-07, 1.00276E-07, 4.54345E-08, 1.28529E-07],
                            [1.05911E-07, 0.00000E+00, 6.03481E-08, 6.20807E-08, 6.65379E-08],
                            [1.03901E-07, 1.16357E-07, 1.77282E-07, 6.12241E-08, 1.68246E-07],
                            [6.42099E-08, 5.82408E-08, 3.50897E-08, 1.41587E-07, 6.02894E-08]
                        ],
                        [
                            [4.35790E-07, 5.28413E-08, 6.09709E-08, 2.61146E-08, 2.55932E-07],
                            [1.36592E-07, 2.03173E-07, 6.40422E-08, 2.55531E-08, 1.59063E-07],
                            [2.33628E-07, 3.94338E-07, 1.14898E-07, 1.76035E-08, 9.71856E-08],
                            [2.10624E-07, 1.56979E-07, 7.03514E-08, 4.10227E-08, 1.43260E-07]
                        ]
                    ]
                ]),
                'error': np.array([
                    [
                        [
                            [1.51165E-02, 1.65362E-02, 1.95638E-02, 2.00471E-02, 1.74294E-02],
                            [1.54432E-02, 1.65796E-02, 1.93011E-02, 1.98625E-02, 1.73169E-02],
                            [1.70852E-02, 1.80477E-02, 2.04493E-02, 2.12808E-02, 1.90279E-02],
                            [1.91640E-02, 2.00755E-02, 2.24192E-02, 2.31940E-02, 2.06925E-02]
                        ],
                        [
                            [9.09560E-03, 1.13354E-02, 1.68719E-02, 1.73306E-02, 1.27127E-02],
                            [9.56337E-03, 1.15957E-02, 1.62495E-02, 1.68587E-02, 1.28723E-02],
                            [1.07933E-02, 1.25307E-02, 1.69082E-02, 1.73571E-02, 1.37630E-02],
                            [1.21292E-02, 1.38951E-02, 1.80609E-02, 1.84843E-02, 1.50679E-02]
                        ],
                        [
                            [6.46985E-03, 9.39907E-03, 1.63465E-02, 1.65062E-02, 1.11913E-02],
                            [7.10451E-03, 9.57794E-03, 1.55160E-02, 1.59039E-02, 1.11509E-02],
                            [8.19050E-03, 1.02979E-02, 1.59845E-02, 1.59556E-02, 1.17764E-02],
                            [9.40942E-03, 1.15396E-02, 1.66056E-02, 1.68655E-02, 1.28912E-02]
                        ]
                    ],
                    [
                        [
                            [0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [1.00000E+00, 1.00000E+00, 1.00000E+00, 0.00000E+00, 0.00000E+00],
                            [1.00000E+00, 1.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00]
                        ],
                        [
                            [1.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [1.00000E+00, 1.00000E+00, 1.00000E+00, 0.00000E+00, 0.00000E+00],
                            [0.00000E+00, 1.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [1.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00]
                        ],
                        [
                            [1.00000E+00, 1.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00],
                            [7.94765E-01, 1.00000E+00, 1.00000E+00, 0.00000E+00, 0.00000E+00],
                            [1.00000E+00, 1.00000E+00, 1.00000E+00, 0.00000E+00, 0.00000E+00],
                            [1.00000E+00, 1.00000E+00, 1.00000E+00, 0.00000E+00, 0.00000E+00]
                        ]
                    ],
                    [
                        [
                            [7.13649E-01, 7.08199E-01, 7.92007E-01, 1.00000E+00, 7.98367E-01],
                            [0.00000E+00, 0.00000E+00, 1.00000E+00, 1.00000E+00, 1.00000E+00],
                            [7.37976E-01, 7.34192E-01, 8.08038E-01, 1.00000E+00, 9.90367E-01],
                            [1.00000E+00, 1.00000E+00, 1.00000E+00, 7.11428E-01, 1.00000E+00]
                        ],
                        [
                            [3.73939E-01, 4.35674E-01, 6.39167E-01, 1.00000E+00, 6.13512E-01],
                            [7.09827E-01, 0.00000E+00, 8.65521E-01, 8.21311E-01, 7.07324E-01],
                            [7.06117E-01, 6.58996E-01, 5.87822E-01, 8.92465E-01, 5.85102E-01],
                            [5.99586E-01, 7.93568E-01, 1.00000E+00, 5.39828E-01, 1.00000E+00]
                        ],
                        [
                            [2.74749E-01, 6.07463E-01, 7.11666E-01, 1.00000E+00, 3.38896E-01],
                            [4.70422E-01, 4.07795E-01, 7.12197E-01, 1.00000E+00, 4.89133E-01],
                            [4.69333E-01, 3.23265E-01, 4.92014E-01, 8.57334E-01, 5.38949E-01],
                            [3.71867E-01, 4.36175E-01, 7.21109E-01, 7.29208E-01, 4.55335E-01]
                        ]
                    ]
                ])
            }
        ]
    })
])
def test_meshtal_parser(mesh_file, expected):
    mesh_file = file_resolver(mesh_file)
    with open(mesh_file) as f:
        text = f.read() + '\n'
    meshtal_lexer.begin('INITIAL')
    tallies = meshtal_parser.parse(text, lexer=meshtal_lexer)
    assert tallies.keys() == expected.keys()
    for k in ['date', 'histories', 'title']:
        assert tallies[k] == expected[k]
    for t, a in zip(tallies['tallies'], expected['tallies']):
        for k in ['name', 'particle', 'geom']:
            assert t[k] == a[k]
        for k, v in a['bins'].items():
            np.testing.assert_array_almost_equal(t['bins'][k], v)
        np.testing.assert_array_almost_equal(t['result'], a['result'])
        np.testing.assert_array_almost_equal(t['error'], a['error'])


@pytest.mark.parametrize('mctal_file, expected', [
    ('parser_test_data/mctal.t', {
        4: {
            'name': 4, 'particles': {'N'}, 'type': 'Non',
            'dims': [4], 'vars': ['f'], 'bins': [[1, 2, 3, 4]],
            'comment': "One line comment",
            'data': np.array([8.80794E-05, 1.50383E-05, 2.11945E-06,
                              8.56005E-06]),
            'error': np.array([0.0004, 0.0044, 0.0094, 0.0015])
        },
        5: {
            'name': 5, 'particles': {'N'}, 'type': 'Point',
            'comment': "This is" + ' ' * 70 + '\n     multiline' + ' ' * 68 + \
                '\n     comment',
            'dims': [2, 17], 'vars': ['d', 'e'], 'bins': [
                [0, 1],
                [0.00000E+00, 9.33333E-01, 1.86667E+00, 2.80000E+00,
                 3.73333E+00, 4.66667E+00, 5.60000E+00, 6.53333E+00,
                 7.46667E+00, 8.40000E+00, 9.33333E+00, 1.02667E+01,
                 1.12000E+01, 1.21333E+01, 1.30667E+01, 1.40000E+01]
            ],
            'data': np.array([
                [
                    0.00000E+00, 1.58216E-06, 1.87159E-07, 6.61835E-08,
                    2.77078E-08, 1.91715E-08, 2.10682E-08, 1.63592E-08,
                    2.00616E-08, 7.62970E-09, 1.07499E-08, 1.65694E-08,
                    2.26494E-08, 2.65932E-08, 1.63491E-08, 9.16554E-09,
                    2.04958E-06
                ],
                [
                    0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
                    0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
                    0.00000E+00, 0.00000E+00, 0.00000E+00, 6.20784E-10,
                    6.90270E-10, 1.42735E-09, 1.00714E-09, 7.39058E-10,
                    4.48460E-09
                ]
            ]),
            'error': np.array([
                [
                    0.0000, 0.0093, 0.0105, 0.0162, 0.0267, 0.0360, 0.0353,
                    0.0322, 0.0298, 0.0493, 0.0459, 0.0336, 0.0321, 0.0300,
                    0.0414, 0.0601, 0.0076
                ],
                [
                    0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
                    0.0000, 0.0000, 0.0000, 0.0000, 0.0005, 0.0004, 0.0002,
                    0.0004, 0.0005, 0.0001
                ]
            ])
        },
        14: {
            'name': 14, 'particles': {'N'}, 'type': 'Non', 'comment': '',
            'dims': [3, 2, 17], 'vars': ['f', 'm', 'e'], 'bins': [
                [1, 2, 3], [0, 1],
                [0.00000E+00, 9.33333E-01, 1.86667E+00, 2.80000E+00,
                 3.73333E+00, 4.66667E+00, 5.60000E+00, 6.53333E+00,
                 7.46667E+00, 8.40000E+00, 9.33333E+00, 1.02667E+01,
                 1.12000E+01, 1.21333E+01, 1.30667E+01, 1.40000E+01]
            ],
            'data': np.array([
                [
                    [
                        0.00000E+00, 9.64735E-09, 6.09468E-07, 1.32468E-06,
                        1.09940E-06, 1.00315E-06, 9.19119E-07, 8.83431E-07,
                        1.09927E-06, 1.16016E-06, 1.43665E-06, 3.69534E-06,
                        6.30478E-06, 1.00136E-05, 5.43929E-06, 3.03981E-06,
                        3.80378E-05
                    ],
                    [
                        0.00000E+00, 2.48959E-04, 2.39806E-07, 8.52906E-08,
                        2.85414E-08, 9.16832E-09, 3.49531E-09, 1.89229E-09,
                        1.36790E-09, 1.19742E-09, 1.49466E-09, 4.43477E-09,
                        7.74861E-09, 1.18686E-08, 5.52138E-09, 2.36672E-09,
                        2.49363E-04
                    ]
                ],
                [
                    [
                        0.00000E+00, 6.56033E-09, 2.51919E-07, 3.07402E-07,
                        1.25075E-07, 1.00504E-07, 9.04613E-08, 8.45778E-08,
                        1.20215E-07, 7.73971E-08, 8.84206E-08, 1.33830E-07,
                        1.80750E-07, 2.16944E-07, 1.29120E-07, 6.92425E-08,
                        1.98242E-06
                    ],
                    [
                        0.00000E+00, 8.63466E-05, 1.26651E-07, 2.12696E-08,
                        3.34729E-09, 9.23087E-10, 3.42818E-10, 1.84524E-10,
                        1.49631E-10, 7.98288E-11, 9.18360E-11, 1.58698E-10,
                        2.22582E-10, 2.58535E-10, 1.35119E-10, 5.63011E-11,
                        8.65005E-05
                    ]
                ],
                [
                    [
                        0.00000E+00, 1.13397E-09, 3.11299E-08, 3.65827E-08,
                        1.37816E-08, 1.03438E-08, 1.13258E-08, 1.12447E-08,
                        1.83109E-08, 8.58871E-09, 8.87751E-09, 1.71934E-08,
                        2.18344E-08, 2.53578E-08, 1.51028E-08, 7.96793E-09,
                        2.38776E-07
                    ],
                    [
                        0.00000E+00, 1.94119E-05, 1.76797E-08, 2.54610E-09,
                        3.68989E-10, 9.48239E-11, 4.25000E-11, 2.46131E-11,
                        2.29424E-11, 8.80678E-12, 9.18887E-12, 2.03863E-11,
                        2.69006E-11, 3.02948E-11, 1.58845E-11, 6.57886E-12,
                        1.94328E-05
                    ]
                ]
            ]),
            'error': np.array([
                [
                    [
                        0.0000, 0.0018, 0.0012, 0.0011, 0.0012, 0.0013, 0.0014,
                        0.0016, 0.0017, 0.0017, 0.0016, 0.0011, 0.0008, 0.0006,
                        0.0009, 0.0013, 0.0004
                    ],
                    [
                        0.0000, 0.0021, 0.0009, 0.0011, 0.0012, 0.0013, 0.0014,
                        0.0016, 0.0017, 0.0017, 0.0016, 0.0011, 0.0008, 0.0006,
                        0.0009, 0.0013, 0.0021
                    ]
                ],
                [
                    [
                        0.0000, 0.0123, 0.0080, 0.0090, 0.0124, 0.0148, 0.0167,
                        0.0186, 0.0198, 0.0223, 0.0220, 0.0185, 0.0163, 0.0150,
                        0.0201, 0.0295, 0.0054
                    ],
                    [
                        0.0000, 0.0241, 0.0063, 0.0092, 0.0128, 0.0151, 0.0168,
                        0.0185, 0.0198, 0.0222, 0.0220, 0.0186, 0.0163, 0.0150,
                        0.0201, 0.0294, 0.0241
                    ]
                ],
                [
                    [
                        0.0000, 0.0823, 0.0313, 0.0353, 0.0552, 0.0638, 0.0593,
                        0.0654, 0.0606, 0.0918, 0.0861, 0.0633, 0.0580, 0.0539,
                        0.0706, 0.1043, 0.0163
                    ],
                    [
                        0.0000, 0.1095, 0.0227, 0.0362, 0.0573, 0.0677, 0.0604,
                        0.0653, 0.0606, 0.0917, 0.0860, 0.0634, 0.0580, 0.0539,
                        0.0703, 0.1037, 0.1094
                    ]
                ]
            ])
        },
        24: {
            'name': 24, 'particles': {'N'}, 'type': 'Non', 'comment': '',
            'dims': [2, 6, 7], 'vars': ['f', 'u', 'e'],
            'bins': [
                [2, 3], [0, 1, 2, 3, 4, 5], [0.0000E+00, 3.0000E+00,
                 6.0000E+00, 9.0000E+00, 1.2000E+01, 1.5000E+01]
            ],
            'data': np.array([
                [
                        [
                            0.00000E+00, 5.72625E-08, 3.36136E-08, 2.99109E-08,
                            5.03426E-08, 0.00000E+00, 1.71130E-07
                        ],
                        [
                            0.00000E+00, 1.12613E-07, 6.67524E-08, 5.45806E-08,
                            1.26970E-07, 0.00000E+00, 3.60916E-07
                        ],
                        [
                            0.00000E+00, 2.29959E-07, 1.25578E-07, 1.25896E-07,
                            2.90195E-07, 0.00000E+00, 7.71627E-07
                        ],
                        [
                            0.00000E+00, 1.28752E-07, 6.58607E-08, 6.13112E-08,
                            6.26042E-08, 1.20676E-07, 4.39204E-07
                        ],
                        [
                            0.00000E+00, 6.79069E-08, 3.00027E-08, 3.27493E-08,
                            2.63134E-08, 8.25692E-08, 2.39542E-07
                        ],
                        [
                            0.00000E+00, 5.96493E-07, 3.21807E-07, 3.04448E-07,
                            5.56425E-07, 2.03245E-07, 1.98242E-06
                        ]
                ],
                [
                        [
                            0.00000E+00, 7.21429E-09, 4.22791E-09, 3.44185E-09,
                            6.45356E-09, 0.00000E+00, 2.13376E-08
                        ],
                        [
                            0.00000E+00, 1.42111E-08, 7.67042E-09, 6.38826E-09,
                            1.57524E-08, 0.00000E+00, 4.40222E-08
                        ],
                        [
                            0.00000E+00, 2.76409E-08, 1.38688E-08, 1.62544E-08,
                            3.35833E-08, 0.00000E+00, 9.13475E-08
                        ],
                        [
                            0.00000E+00, 1.59835E-08, 7.21256E-09, 9.03184E-09,
                            7.71240E-09, 1.37593E-08, 5.36996E-08
                        ],
                        [
                            0.00000E+00, 7.66382E-09, 3.31290E-09, 4.85495E-09,
                            2.55185E-09, 9.98544E-09, 2.83690E-08
                        ],
                        [
                            0.00000E+00, 7.27137E-08, 3.62926E-08, 3.99713E-08,
                            6.60534E-08, 2.37447E-08, 2.38776E-07
                        ]
                ]
            ]),
            'error': np.array([
                [
                        [
                            0.0000, 0.0231, 0.0309, 0.0410, 0.0329, 0.0000,
                            0.0183
                        ],
                        [
                            0.0000, 0.0162, 0.0219, 0.0297, 0.0210, 0.0000,
                            0.0128
                        ],
                        [
                            0.0000, 0.0110, 0.0155, 0.0195, 0.0136, 0.0000,
                            0.0086
                        ],
                        [
                            0.0000, 0.0150, 0.0214, 0.0275, 0.0272, 0.0211,
                            0.0116
                        ],
                        [
                            0.0000, 0.0201, 0.0313, 0.0379, 0.0404, 0.0269,
                            0.0161
                        ],
                        [
                            0.0000, 0.0069, 0.0098, 0.0125, 0.0098, 0.0166,
                            0.0054
                        ]
                ],
                [
                        [
                            0.0000, 0.0786, 0.1042, 0.1448, 0.1081, 0.0000,
                            0.0548
                        ],
                        [
                            0.0000, 0.0526, 0.0743, 0.1044, 0.0701, 0.0000,
                            0.0381
                        ],
                        [
                            0.0000, 0.0390, 0.0560, 0.0622, 0.0462, 0.0000,
                            0.0260
                        ],
                        [
                            0.0000, 0.0506, 0.0768, 0.0858, 0.0920, 0.0746,
                            0.0344
                        ],
                        [
                            0.0000, 0.0709, 0.1118, 0.1183, 0.1642, 0.0910,
                            0.0486
                        ],
                        [
                            0.0000, 0.0238, 0.0345, 0.0407, 0.0331, 0.0577,
                            0.0163
                        ]
                ]
            ])
        }
    })
])
def test_mctal_parser(mctal_file, expected):
    mctal_file = file_resolver(mctal_file)
    tallies = read_mctal(mctal_file)
    assert tallies.keys() == expected.keys()
    for name, tally in tallies.items():
        assert tally.keys() == expected[name].keys()
        assert tally['name'] == expected[name]['name']
        assert tally['particles'] == expected[name]['particles']
        assert tally['type'] == expected[name]['type']
        assert tally['dims'] == expected[name]['dims']
        assert tally['vars'] == expected[name]['vars']
        assert tally['bins'] == expected[name]['bins']
        np.testing.assert_array_almost_equal(
            tally['data'], expected[name]['data'], decimal=2
        )
        np.testing.assert_array_almost_equal(tally['error'], expected[name]['error'])
