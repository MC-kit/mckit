.. _material

Материалы
=========

Материал задает изотопный состав и плотность (как массовую так и атомную) среды.
Плотность среды можно характеризовать либо массовой плотностью :math:`\rho`,
либо концентрацией атомов вещества :math:`n`. Соответственно, эти две величины
связаны между собой соотношениями:

.. math:: n = \cfrac{\rho N_a}{\mu}
   :label: n_rho

.. math:: \rho = \cfrac{n \mu}{N_a}
   :label: rho_n

где :math:`\mu` - молярная масса вещества, :math:`N_a` - число Авогадро.
Проще всего с материалами работать, если заданы концентрации изотопов и молярная
масса вещества :math:`\mu`. Полная концентрация атомов вещества в этом случае
можно найти просуммировав концентрации всех изотопов:

.. math:: n=\sum_i{n_i}

Поэтому будем находить именно эти величины. Изотопный состав можно задать
несколькими способами.

1. Заданы массовые доли :math:`\omega_i`
----------------------------------------

.. math:: \mu&=\left(\sum_i{\cfrac{\omega_i}{\mu_i}}\right)^{-1}\\
   n_i &= \mu n \cfrac{\omega_i}{\mu_i}

В случае, если задана массовая плотность вещества, то полную концентацию можно
найти по формуле :eq:`n_rho` после вычисления :math:`\mu`.

2. Заданы атомные концентрации :math:`n_i`
------------------------------------------

.. math:: \mu=\cfrac{\sum_i{n_i \mu_i}}{n}

Здесь нет нужды задавать плотность. Если плотность задана, то см. следующий
пункт.

3. Заданы атомные доли :math:`\eta_i`
-------------------------------------

Атомная доля вычисляется по формуле :math:`\eta_i = \cfrac{N_i}{N}`, где
:math:`N_i` - число атомов i-го изотопа, :math:`N` - полное число атомов.

.. math:: \mu=\sum_i{\eta_i \mu_i}

Если задана массовая плотность вещества, то концентрация рассчитывается по
формуле :eq:`n_rho`.

4. Заданы и массовые доли :math:`\omega_i` и атомные доли :math:`\eta_i`
------------------------------------------------------------------------

.. math:: \mu&=\cfrac{\mu I_\omega + J_\eta}{\mu J_\omega + I_\eta}\\
   I_\omega &= \sum_i{\omega_i}\\
   I_\eta &= \sum_i{\eta_i}\\
   J_\omega &= \sum_i{\cfrac{\omega_i}{\mu_i}}\\
   J_\eta &= \sum_i{\eta_i \mu_i}

Отсюда можно прийти к уравнению относительно :math:`\mu`:

.. math:: J_\omega\mu^2 + (I_\eta-I_\omega)\mu - J_\eta=0

Решая это уравнение можно найти молярную массу вещества:

.. math:: \mu=\cfrac{\sqrt{(I_\eta-I_\omega)^2+4J_\omega J_\eta}-
   (I_\eta-I_\omega)}{2J_\omega}
   :label: molar_mass_1

Эта формула плохо подходит для вычисления молярной массы, когда :math:`J_\omega`
близко к 0. Поэтому домножим числитель на сопряженное. В этом случае получим
формулу:

.. math:: \mu=\cfrac{2J_\eta}{\sqrt{(I_\eta-I_\omega)^2+4J_\omega J_\eta}+
   (I_\eta-I_\omega)}
   :label: molar_mass_2

Эта формула, в свою очередь, не подходит для численного счета, когда
:math:`J_\eta` близко к 0. Таким образом, можно использовать формулу
:eq:`molar_mass_1`, если :math:`I_\omega\geqslant I_\eta`, и формулой
:eq:`molar_mass_2`, если :math:`I_\omega<I_\eta`. Смысл этого, если в кратце,
заключается в том, что к корню должно прибавляться положительное число - это
гарантия, что в числителе и знаменателе будут конечные числа.

Концентрации можно посчитать по формулам:

.. math:: n_i &= \mu n \cfrac{\omega_i}{\mu_i}\\
   n_i &= n \eta_i

Стоит отметить, что этот случай включает в себя варианты 1 и 3, рассмотренные
выше. При этом, тут автоматически учитывается нормировка долей на 1. Поэтому
этот подход универсален.

